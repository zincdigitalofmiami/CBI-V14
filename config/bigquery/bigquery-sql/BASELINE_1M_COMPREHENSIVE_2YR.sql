-- ⚠️ CRITICAL: NO FAKE DATA ⚠️
-- This project uses ONLY real, verified data sources. NO placeholders, NO synthetic data, NO fake values.
-- All data must come from authenticated APIs, official sources, or validated historical records.
--

-- ============================================
-- COMPREHENSIVE BASELINE TRAINING - 1 MONTH HORIZON
-- 2024+ Data with ALL 220 Yahoo Finance Symbols
-- ============================================
-- Version: 2.0 (220 Symbols)
-- Date: November 7, 2025
--
-- OBJECTIVE: Discovery baseline to identify which features actually matter
-- ISOLATION: Completely separate from production models/tables
-- MODEL: bqml_1m_baseline_exploratory_220_symbols (separate from bqml_1m_baseline_exploratory)
-- TABLE: full_220_comprehensive_2yr (separate from zl_training_prod_allhistory_1m)
--
-- CONFIGURATION:
-- - Max Iterations: 300 (was 50 - stopped early)
-- - Early Stop: TRUE (stops when learning plateaus)
-- - Min Relative Progress: 0.00001 (0.001% - was 0.0001)
-- - L1 Regularization: 0.7 (looser - was 1.5, too aggressive)
-- - L2 Regularization: 0.3 (looser - was 0.5)
-- - Data Split: SEQ (time-aware - was RANDOM, caused leakage)
--
-- EXPECTED FEATURES: ~2,233 total
-- - Base production: ~638 features
-- - Yahoo symbols: ~1,540 features (220 symbols × 7 indicators)
-- - Correlations: ~48 features
-- - Interactions: ~22 features
-- - NULL columns: ~1,155 will be excluded (165 symbols × 7 indicators)
--
-- PERFORMANCE NOTES:
-- - Table creation: ~5-10 minutes (pivoting 220 symbols)
-- - Model training: ~15-25 minutes (1,500+ features, 50 iterations)
-- - Estimated cost: $3-10 (depends on data volume, 2024+ only)
-- - Memory: May require slot reservation for large feature set
--
-- EXECUTION STRATEGY:
-- 1. Run pre-flight check queries first (uncomment above)
-- 2. Execute STEP 1 (table creation) - monitor for errors
-- 3. Verify table was created successfully before proceeding
-- 4. Execute STEP 2 (model training) - can take 15-25 minutes (50 iterations)
-- 5. Check training progress via ML.TRAINING_INFO if needed
-- 6. Run STEP 3 & 4 (evaluation and feature importance)
--
-- TROUBLESHOOTING:
-- - If table creation fails: Check Yahoo data availability for 2024+
-- - If training times out: Already set to 50 iterations (early_stop will likely trigger sooner)
-- - If memory errors: Use slot reservation or reduce feature set
-- - All issues should be caught in pre-flight checks before execution
-- ============================================

-- ============================================
-- PRE-FLIGHT CHECK: Verify data exists
-- ============================================
-- Run this first to verify data availability before full execution
/*
SELECT 
  'zl_training_prod_allhistory_1m' as table_name,
  COUNT(*) as total_rows,
  COUNTIF(target_1m IS NOT NULL) as rows_with_target,
  MIN(date) as earliest_date,
  MAX(date) as latest_date
FROM `cbi-v14.training.zl_training_prod_allhistory_1m`
WHERE date >= '2024-01-01';

SELECT 
  'yahoo_finance_complete_enterprise' as table_name,
  COUNT(DISTINCT symbol) as unique_symbols,
  COUNT(*) as total_rows,
  MIN(DATE(TIMESTAMP_MICROS(CAST(date AS INT64)))) as earliest_date,
  MAX(DATE(TIMESTAMP_MICROS(CAST(date AS INT64)))) as latest_date
FROM `cbi-v14.yahoo_finance_comprehensive.yahoo_finance_complete_enterprise`
WHERE DATE(TIMESTAMP_MICROS(CAST(date AS INT64))) >= '2024-01-01';
*/

-- ============================================
-- STEP 1: CREATE COMPREHENSIVE FEATURE TABLE
-- ============================================

CREATE OR REPLACE TABLE `cbi-v14.models_v4.full_220_comprehensive_2yr` AS

WITH 
-- Base production features (read-only, never modified)
base_production AS (
  SELECT * 
  FROM `cbi-v14.training.zl_training_prod_allhistory_1m`
  WHERE date >= '2024-01-01'
    AND target_1m IS NOT NULL
),

-- Yahoo Finance data - pivot all symbols with technical indicators
-- NOTE: Timestamps in source table are NANOSECONDS (not microseconds)
yahoo_data AS (
  SELECT 
    DATE(TIMESTAMP_MICROS(CAST(date/1000 AS INT64))) as date,  -- Convert nanoseconds to microseconds
    symbol,
    close,
    rsi_14,
    ma_30d,
    macd_line,
    atr_14,
    bb_upper,
    momentum_10
  FROM `cbi-v14.yahoo_finance_comprehensive.yahoo_finance_complete_enterprise`
  WHERE date IS NOT NULL
    AND date > 1704067200000000000  -- 2024-01-01 in NANOSECONDS (note the extra 000)
    AND date < 1767225600000000000  -- 2026-01-01 in NANOSECONDS
),

-- Symbol list for CROSS JOIN (210 unique symbols)
symbol_list AS (
  SELECT symbol FROM UNNEST([
    'HO=F', 'RB=F', 'NG=F', 'SB=F', 'ICLN', 'TAN', 'DBA', 'VEGI', 'CNRG', 'XLE',
    'PAVE', 'GEVO', 'AMTX', 'CLNE', 'CORN', 'WEAT', 'SOYB', 'COW', 'PLUG', 'FCEL',
    'BE', 'CF', 'MOS', 'NTR', 'VST', 'OXY', 'ENPH', 'SEDG', 'WM', 'RSG',
    'DX-Y.NYB', 'EURUSD=X', 'JPYUSD=X', 'GBPUSD=X', 'AUDUSD=X', 'CADUSD=X', 'CNYUSD=X', 'BRLUSD=X', 'MXNUSD=X', 'ARSUSD=X',
    'INRUSD=X', 'ZARUSD=X', 'RUBUSD=X', 'TRYUSD=X', 'KRWUSD=X', 'SGDUSD=X', 'MYRUSD=X', 'THBUSD=X', 'IDRRUSD=X', 'PHPUSD=X',
    'UUP', 'UDN', 'DBV', 'CEW', 'FXE', 'FXY', 'FXA', 'FXC', 'CYB', 'BZF',
    'DXY', 'USDU', 'USDD', 'TIP', 'VTIP', '^VIX', '^VXN', '^RVX', 'VXX', 'VIXY',
    'UVXY', 'SVXY', 'VIXM', '^VVIX', '^SKEW', '^VXD', '^OVX', '^GVZ', '^EVZ', 'VOLI',
    'VIX3M', 'VIX6M', '^CPCE', '^CPCI', 'CL=F', 'BZ=F', 'QM=F', 'MCL=F', 'B0=F', 'PN0=F',
    'MTF=F', 'URA', 'USO', 'UNG', 'XOP', 'IXC', 'IEO', 'XOM', 'CVX', 'COP',
    'SLB', 'EOG', 'MPC', 'VLO', 'PSX', 'ZL=F', 'ZS=F', 'ZM=F', 'ZC=F', 'ZW=F',
    'ZO=F', 'ZR=F', 'LE=F', 'HE=F', 'GF=F', 'DC=F', 'DY=F', 'RS=F', 'CT=F', 'KC=F',
    'CC=F', 'OJ=F', 'LBS=F', 'BAL', 'JO', 'NIB', 'SGG', 'GC=F', 'SI=F', 'HG=F',
    'PL=F', 'PA=F', 'ALI=F', 'GLD', 'SLV', 'COPX', 'PPLT', 'PALL', 'DBB', 'XME',
    '^TNX', '^TYX', '^FVX', '^IRX', 'TLT', 'IEF', 'SHY', 'AGG', 'BND', 'BNDX',
    'EMB', 'PCY', 'ADM', 'BG', 'DAR', 'TSN', 'DE', 'AGCO', 'CVGW', 'SEB',
    'WILC', 'HRL', 'CAG', 'GIS', 'K', 'CPB', 'ANDE', 'LW', 'CALM', 'FDP',
    'AGRO', 'CRESY', 'CNHI', 'TWI', 'CTVA', 'SMG', 'SBS', '^GSPC', '^DJI', '^IXIC',
    '^RUT', 'EEM', 'FXI', 'KWEB', 'MCHI', 'EWZ', 'ARGT', 'XLB', 'XLI', 'XLY',
    'XLP', 'XLV', 'XLK', 'XLF', 'HYG', 'LQD', 'JNK', 'BKLN', 'ANGL', 'FALN',
    'EMHY', 'VWOB', 'BDRY', 'SHIP', 'SBLK', 'NMM', 'EGLE', 'SB', 'GOGL', 'TOPS'
  ]) AS symbol
),

-- Date list for CROSS JOIN (distinct dates from yahoo_data)
date_list AS (
  SELECT DISTINCT date
  FROM yahoo_data
  WHERE date IS NOT NULL
),

-- Pivot all 210 symbols with CROSS JOIN to force all 1,470 columns (210 × 7 indicators)
-- Yahoo pivoted with CROSS JOIN - 210 symbols × 7 indicators = 1,470 columns
yahoo_pivoted AS (
  SELECT
    d.date,
    MAX(IF(s.symbol='ADM', y.close, NULL)) as adm_close_yh,
    MAX(IF(s.symbol='ADM', y.rsi_14, NULL)) as adm_rsi_14_yh,
    MAX(IF(s.symbol='ADM', y.ma_30d, NULL)) as adm_ma_30d_yh,
    MAX(IF(s.symbol='ADM', y.macd_line, NULL)) as adm_macd_yh,
    MAX(IF(s.symbol='ADM', y.atr_14, NULL)) as adm_atr_yh,
    MAX(IF(s.symbol='ADM', y.bb_upper, NULL)) as adm_bb_upper_yh,
    MAX(IF(s.symbol='ADM', y.momentum_10, NULL)) as adm_momentum_yh,
    MAX(IF(s.symbol='AGCO', y.close, NULL)) as agco_close,
    MAX(IF(s.symbol='AGCO', y.rsi_14, NULL)) as agco_rsi_14,
    MAX(IF(s.symbol='AGCO', y.ma_30d, NULL)) as agco_ma_30d,
    MAX(IF(s.symbol='AGCO', y.macd_line, NULL)) as agco_macd,
    MAX(IF(s.symbol='AGCO', y.atr_14, NULL)) as agco_atr,
    MAX(IF(s.symbol='AGCO', y.bb_upper, NULL)) as agco_bb_upper,
    MAX(IF(s.symbol='AGCO', y.momentum_10, NULL)) as agco_momentum,
    MAX(IF(s.symbol='AGG', y.close, NULL)) as agg_close,
    MAX(IF(s.symbol='AGG', y.rsi_14, NULL)) as agg_rsi_14,
    MAX(IF(s.symbol='AGG', y.ma_30d, NULL)) as agg_ma_30d,
    MAX(IF(s.symbol='AGG', y.macd_line, NULL)) as agg_macd,
    MAX(IF(s.symbol='AGG', y.atr_14, NULL)) as agg_atr,
    MAX(IF(s.symbol='AGG', y.bb_upper, NULL)) as agg_bb_upper,
    MAX(IF(s.symbol='AGG', y.momentum_10, NULL)) as agg_momentum,
    MAX(IF(s.symbol='AGRO', y.close, NULL)) as agro_close,
    MAX(IF(s.symbol='AGRO', y.rsi_14, NULL)) as agro_rsi_14,
    MAX(IF(s.symbol='AGRO', y.ma_30d, NULL)) as agro_ma_30d,
    MAX(IF(s.symbol='AGRO', y.macd_line, NULL)) as agro_macd,
    MAX(IF(s.symbol='AGRO', y.atr_14, NULL)) as agro_atr,
    MAX(IF(s.symbol='AGRO', y.bb_upper, NULL)) as agro_bb_upper,
    MAX(IF(s.symbol='AGRO', y.momentum_10, NULL)) as agro_momentum,
    MAX(IF(s.symbol='ALI=F', y.close, NULL)) as ali_f_close,
    MAX(IF(s.symbol='ALI=F', y.rsi_14, NULL)) as ali_f_rsi_14,
    MAX(IF(s.symbol='ALI=F', y.ma_30d, NULL)) as ali_f_ma_30d,
    MAX(IF(s.symbol='ALI=F', y.macd_line, NULL)) as ali_f_macd,
    MAX(IF(s.symbol='ALI=F', y.atr_14, NULL)) as ali_f_atr,
    MAX(IF(s.symbol='ALI=F', y.bb_upper, NULL)) as ali_f_bb_upper,
    MAX(IF(s.symbol='ALI=F', y.momentum_10, NULL)) as ali_f_momentum,
    MAX(IF(s.symbol='AMTX', y.close, NULL)) as amtx_close,
    MAX(IF(s.symbol='AMTX', y.rsi_14, NULL)) as amtx_rsi_14,
    MAX(IF(s.symbol='AMTX', y.ma_30d, NULL)) as amtx_ma_30d,
    MAX(IF(s.symbol='AMTX', y.macd_line, NULL)) as amtx_macd,
    MAX(IF(s.symbol='AMTX', y.atr_14, NULL)) as amtx_atr,
    MAX(IF(s.symbol='AMTX', y.bb_upper, NULL)) as amtx_bb_upper,
    MAX(IF(s.symbol='AMTX', y.momentum_10, NULL)) as amtx_momentum,
    MAX(IF(s.symbol='ANDE', y.close, NULL)) as ande_close,
    MAX(IF(s.symbol='ANDE', y.rsi_14, NULL)) as ande_rsi_14,
    MAX(IF(s.symbol='ANDE', y.ma_30d, NULL)) as ande_ma_30d,
    MAX(IF(s.symbol='ANDE', y.macd_line, NULL)) as ande_macd,
    MAX(IF(s.symbol='ANDE', y.atr_14, NULL)) as ande_atr,
    MAX(IF(s.symbol='ANDE', y.bb_upper, NULL)) as ande_bb_upper,
    MAX(IF(s.symbol='ANDE', y.momentum_10, NULL)) as ande_momentum,
    MAX(IF(s.symbol='ANGL', y.close, NULL)) as angl_close,
    MAX(IF(s.symbol='ANGL', y.rsi_14, NULL)) as angl_rsi_14,
    MAX(IF(s.symbol='ANGL', y.ma_30d, NULL)) as angl_ma_30d,
    MAX(IF(s.symbol='ANGL', y.macd_line, NULL)) as angl_macd,
    MAX(IF(s.symbol='ANGL', y.atr_14, NULL)) as angl_atr,
    MAX(IF(s.symbol='ANGL', y.bb_upper, NULL)) as angl_bb_upper,
    MAX(IF(s.symbol='ANGL', y.momentum_10, NULL)) as angl_momentum,
    MAX(IF(s.symbol='ARGT', y.close, NULL)) as argt_close,
    MAX(IF(s.symbol='ARGT', y.rsi_14, NULL)) as argt_rsi_14,
    MAX(IF(s.symbol='ARGT', y.ma_30d, NULL)) as argt_ma_30d,
    MAX(IF(s.symbol='ARGT', y.macd_line, NULL)) as argt_macd,
    MAX(IF(s.symbol='ARGT', y.atr_14, NULL)) as argt_atr,
    MAX(IF(s.symbol='ARGT', y.bb_upper, NULL)) as argt_bb_upper,
    MAX(IF(s.symbol='ARGT', y.momentum_10, NULL)) as argt_momentum,
    MAX(IF(s.symbol='ARSUSD=X', y.close, NULL)) as arsusd_x_close,
    MAX(IF(s.symbol='ARSUSD=X', y.rsi_14, NULL)) as arsusd_x_rsi_14,
    MAX(IF(s.symbol='ARSUSD=X', y.ma_30d, NULL)) as arsusd_x_ma_30d,
    MAX(IF(s.symbol='ARSUSD=X', y.macd_line, NULL)) as arsusd_x_macd,
    MAX(IF(s.symbol='ARSUSD=X', y.atr_14, NULL)) as arsusd_x_atr,
    MAX(IF(s.symbol='ARSUSD=X', y.bb_upper, NULL)) as arsusd_x_bb_upper,
    MAX(IF(s.symbol='ARSUSD=X', y.momentum_10, NULL)) as arsusd_x_momentum,
    MAX(IF(s.symbol='AUDUSD=X', y.close, NULL)) as audusd_x_close,
    MAX(IF(s.symbol='AUDUSD=X', y.rsi_14, NULL)) as audusd_x_rsi_14,
    MAX(IF(s.symbol='AUDUSD=X', y.ma_30d, NULL)) as audusd_x_ma_30d,
    MAX(IF(s.symbol='AUDUSD=X', y.macd_line, NULL)) as audusd_x_macd,
    MAX(IF(s.symbol='AUDUSD=X', y.atr_14, NULL)) as audusd_x_atr,
    MAX(IF(s.symbol='AUDUSD=X', y.bb_upper, NULL)) as audusd_x_bb_upper,
    MAX(IF(s.symbol='AUDUSD=X', y.momentum_10, NULL)) as audusd_x_momentum,
    MAX(IF(s.symbol='B0=F', y.close, NULL)) as b0_f_close,
    MAX(IF(s.symbol='B0=F', y.rsi_14, NULL)) as b0_f_rsi_14,
    MAX(IF(s.symbol='B0=F', y.ma_30d, NULL)) as b0_f_ma_30d,
    MAX(IF(s.symbol='B0=F', y.macd_line, NULL)) as b0_f_macd,
    MAX(IF(s.symbol='B0=F', y.atr_14, NULL)) as b0_f_atr,
    MAX(IF(s.symbol='B0=F', y.bb_upper, NULL)) as b0_f_bb_upper,
    MAX(IF(s.symbol='B0=F', y.momentum_10, NULL)) as b0_f_momentum,
    MAX(IF(s.symbol='BAL', y.close, NULL)) as bal_close,
    MAX(IF(s.symbol='BAL', y.rsi_14, NULL)) as bal_rsi_14,
    MAX(IF(s.symbol='BAL', y.ma_30d, NULL)) as bal_ma_30d,
    MAX(IF(s.symbol='BAL', y.macd_line, NULL)) as bal_macd,
    MAX(IF(s.symbol='BAL', y.atr_14, NULL)) as bal_atr,
    MAX(IF(s.symbol='BAL', y.bb_upper, NULL)) as bal_bb_upper,
    MAX(IF(s.symbol='BAL', y.momentum_10, NULL)) as bal_momentum,
    MAX(IF(s.symbol='BDRY', y.close, NULL)) as bdry_close,
    MAX(IF(s.symbol='BDRY', y.rsi_14, NULL)) as bdry_rsi_14,
    MAX(IF(s.symbol='BDRY', y.ma_30d, NULL)) as bdry_ma_30d,
    MAX(IF(s.symbol='BDRY', y.macd_line, NULL)) as bdry_macd,
    MAX(IF(s.symbol='BDRY', y.atr_14, NULL)) as bdry_atr,
    MAX(IF(s.symbol='BDRY', y.bb_upper, NULL)) as bdry_bb_upper,
    MAX(IF(s.symbol='BDRY', y.momentum_10, NULL)) as bdry_momentum,
    MAX(IF(s.symbol='BE', y.close, NULL)) as be_close,
    MAX(IF(s.symbol='BE', y.rsi_14, NULL)) as be_rsi_14,
    MAX(IF(s.symbol='BE', y.ma_30d, NULL)) as be_ma_30d,
    MAX(IF(s.symbol='BE', y.macd_line, NULL)) as be_macd,
    MAX(IF(s.symbol='BE', y.atr_14, NULL)) as be_atr,
    MAX(IF(s.symbol='BE', y.bb_upper, NULL)) as be_bb_upper,
    MAX(IF(s.symbol='BE', y.momentum_10, NULL)) as be_momentum,
    MAX(IF(s.symbol='BG', y.close, NULL)) as bg_close_yh,
    MAX(IF(s.symbol='BG', y.rsi_14, NULL)) as bg_rsi_14_yh,
    MAX(IF(s.symbol='BG', y.ma_30d, NULL)) as bg_ma_30d_yh,
    MAX(IF(s.symbol='BG', y.macd_line, NULL)) as bg_macd_yh,
    MAX(IF(s.symbol='BG', y.atr_14, NULL)) as bg_atr_yh,
    MAX(IF(s.symbol='BG', y.bb_upper, NULL)) as bg_bb_upper_yh,
    MAX(IF(s.symbol='BG', y.momentum_10, NULL)) as bg_momentum_yh,
    MAX(IF(s.symbol='BKLN', y.close, NULL)) as bkln_close,
    MAX(IF(s.symbol='BKLN', y.rsi_14, NULL)) as bkln_rsi_14,
    MAX(IF(s.symbol='BKLN', y.ma_30d, NULL)) as bkln_ma_30d,
    MAX(IF(s.symbol='BKLN', y.macd_line, NULL)) as bkln_macd,
    MAX(IF(s.symbol='BKLN', y.atr_14, NULL)) as bkln_atr,
    MAX(IF(s.symbol='BKLN', y.bb_upper, NULL)) as bkln_bb_upper,
    MAX(IF(s.symbol='BKLN', y.momentum_10, NULL)) as bkln_momentum,
    MAX(IF(s.symbol='BND', y.close, NULL)) as bnd_close,
    MAX(IF(s.symbol='BND', y.rsi_14, NULL)) as bnd_rsi_14,
    MAX(IF(s.symbol='BND', y.ma_30d, NULL)) as bnd_ma_30d,
    MAX(IF(s.symbol='BND', y.macd_line, NULL)) as bnd_macd,
    MAX(IF(s.symbol='BND', y.atr_14, NULL)) as bnd_atr,
    MAX(IF(s.symbol='BND', y.bb_upper, NULL)) as bnd_bb_upper,
    MAX(IF(s.symbol='BND', y.momentum_10, NULL)) as bnd_momentum,
    MAX(IF(s.symbol='BNDX', y.close, NULL)) as bndx_close,
    MAX(IF(s.symbol='BNDX', y.rsi_14, NULL)) as bndx_rsi_14,
    MAX(IF(s.symbol='BNDX', y.ma_30d, NULL)) as bndx_ma_30d,
    MAX(IF(s.symbol='BNDX', y.macd_line, NULL)) as bndx_macd,
    MAX(IF(s.symbol='BNDX', y.atr_14, NULL)) as bndx_atr,
    MAX(IF(s.symbol='BNDX', y.bb_upper, NULL)) as bndx_bb_upper,
    MAX(IF(s.symbol='BNDX', y.momentum_10, NULL)) as bndx_momentum,
    MAX(IF(s.symbol='BRLUSD=X', y.close, NULL)) as brlusd_x_close,
    MAX(IF(s.symbol='BRLUSD=X', y.rsi_14, NULL)) as brlusd_x_rsi_14,
    MAX(IF(s.symbol='BRLUSD=X', y.ma_30d, NULL)) as brlusd_x_ma_30d,
    MAX(IF(s.symbol='BRLUSD=X', y.macd_line, NULL)) as brlusd_x_macd,
    MAX(IF(s.symbol='BRLUSD=X', y.atr_14, NULL)) as brlusd_x_atr,
    MAX(IF(s.symbol='BRLUSD=X', y.bb_upper, NULL)) as brlusd_x_bb_upper,
    MAX(IF(s.symbol='BRLUSD=X', y.momentum_10, NULL)) as brlusd_x_momentum,
    MAX(IF(s.symbol='BZ=F', y.close, NULL)) as bz_f_close_yh,
    MAX(IF(s.symbol='BZ=F', y.rsi_14, NULL)) as bz_f_rsi_14_yh,
    MAX(IF(s.symbol='BZ=F', y.ma_30d, NULL)) as bz_f_ma_30d_yh,
    MAX(IF(s.symbol='BZ=F', y.macd_line, NULL)) as bz_f_macd_yh,
    MAX(IF(s.symbol='BZ=F', y.atr_14, NULL)) as bz_f_atr_yh,
    MAX(IF(s.symbol='BZ=F', y.bb_upper, NULL)) as bz_f_bb_upper_yh,
    MAX(IF(s.symbol='BZ=F', y.momentum_10, NULL)) as bz_f_momentum_yh,
    MAX(IF(s.symbol='BZF', y.close, NULL)) as bzf_close,
    MAX(IF(s.symbol='BZF', y.rsi_14, NULL)) as bzf_rsi_14,
    MAX(IF(s.symbol='BZF', y.ma_30d, NULL)) as bzf_ma_30d,
    MAX(IF(s.symbol='BZF', y.macd_line, NULL)) as bzf_macd,
    MAX(IF(s.symbol='BZF', y.atr_14, NULL)) as bzf_atr,
    MAX(IF(s.symbol='BZF', y.bb_upper, NULL)) as bzf_bb_upper,
    MAX(IF(s.symbol='BZF', y.momentum_10, NULL)) as bzf_momentum,
    MAX(IF(s.symbol='CADUSD=X', y.close, NULL)) as cadusd_x_close,
    MAX(IF(s.symbol='CADUSD=X', y.rsi_14, NULL)) as cadusd_x_rsi_14,
    MAX(IF(s.symbol='CADUSD=X', y.ma_30d, NULL)) as cadusd_x_ma_30d,
    MAX(IF(s.symbol='CADUSD=X', y.macd_line, NULL)) as cadusd_x_macd,
    MAX(IF(s.symbol='CADUSD=X', y.atr_14, NULL)) as cadusd_x_atr,
    MAX(IF(s.symbol='CADUSD=X', y.bb_upper, NULL)) as cadusd_x_bb_upper,
    MAX(IF(s.symbol='CADUSD=X', y.momentum_10, NULL)) as cadusd_x_momentum,
    MAX(IF(s.symbol='CAG', y.close, NULL)) as cag_close,
    MAX(IF(s.symbol='CAG', y.rsi_14, NULL)) as cag_rsi_14,
    MAX(IF(s.symbol='CAG', y.ma_30d, NULL)) as cag_ma_30d,
    MAX(IF(s.symbol='CAG', y.macd_line, NULL)) as cag_macd,
    MAX(IF(s.symbol='CAG', y.atr_14, NULL)) as cag_atr,
    MAX(IF(s.symbol='CAG', y.bb_upper, NULL)) as cag_bb_upper,
    MAX(IF(s.symbol='CAG', y.momentum_10, NULL)) as cag_momentum,
    MAX(IF(s.symbol='CALM', y.close, NULL)) as calm_close,
    MAX(IF(s.symbol='CALM', y.rsi_14, NULL)) as calm_rsi_14,
    MAX(IF(s.symbol='CALM', y.ma_30d, NULL)) as calm_ma_30d,
    MAX(IF(s.symbol='CALM', y.macd_line, NULL)) as calm_macd,
    MAX(IF(s.symbol='CALM', y.atr_14, NULL)) as calm_atr,
    MAX(IF(s.symbol='CALM', y.bb_upper, NULL)) as calm_bb_upper,
    MAX(IF(s.symbol='CALM', y.momentum_10, NULL)) as calm_momentum,
    MAX(IF(s.symbol='CC=F', y.close, NULL)) as cc_f_close,
    MAX(IF(s.symbol='CC=F', y.rsi_14, NULL)) as cc_f_rsi_14,
    MAX(IF(s.symbol='CC=F', y.ma_30d, NULL)) as cc_f_ma_30d,
    MAX(IF(s.symbol='CC=F', y.macd_line, NULL)) as cc_f_macd,
    MAX(IF(s.symbol='CC=F', y.atr_14, NULL)) as cc_f_atr,
    MAX(IF(s.symbol='CC=F', y.bb_upper, NULL)) as cc_f_bb_upper,
    MAX(IF(s.symbol='CC=F', y.momentum_10, NULL)) as cc_f_momentum,
    MAX(IF(s.symbol='CEW', y.close, NULL)) as cew_close,
    MAX(IF(s.symbol='CEW', y.rsi_14, NULL)) as cew_rsi_14,
    MAX(IF(s.symbol='CEW', y.ma_30d, NULL)) as cew_ma_30d,
    MAX(IF(s.symbol='CEW', y.macd_line, NULL)) as cew_macd,
    MAX(IF(s.symbol='CEW', y.atr_14, NULL)) as cew_atr,
    MAX(IF(s.symbol='CEW', y.bb_upper, NULL)) as cew_bb_upper,
    MAX(IF(s.symbol='CEW', y.momentum_10, NULL)) as cew_momentum,
    MAX(IF(s.symbol='CF', y.close, NULL)) as cf_close_yh,
    MAX(IF(s.symbol='CF', y.rsi_14, NULL)) as cf_rsi_14_yh,
    MAX(IF(s.symbol='CF', y.ma_30d, NULL)) as cf_ma_30d_yh,
    MAX(IF(s.symbol='CF', y.macd_line, NULL)) as cf_macd_yh,
    MAX(IF(s.symbol='CF', y.atr_14, NULL)) as cf_atr_yh,
    MAX(IF(s.symbol='CF', y.bb_upper, NULL)) as cf_bb_upper_yh,
    MAX(IF(s.symbol='CF', y.momentum_10, NULL)) as cf_momentum_yh,
    MAX(IF(s.symbol='CL=F', y.close, NULL)) as cl_f_close_yh,
    MAX(IF(s.symbol='CL=F', y.rsi_14, NULL)) as cl_f_rsi_14_yh,
    MAX(IF(s.symbol='CL=F', y.ma_30d, NULL)) as cl_f_ma_30d_yh,
    MAX(IF(s.symbol='CL=F', y.macd_line, NULL)) as cl_f_macd_yh,
    MAX(IF(s.symbol='CL=F', y.atr_14, NULL)) as cl_f_atr_yh,
    MAX(IF(s.symbol='CL=F', y.bb_upper, NULL)) as cl_f_bb_upper_yh,
    MAX(IF(s.symbol='CL=F', y.momentum_10, NULL)) as cl_f_momentum_yh,
    MAX(IF(s.symbol='CLNE', y.close, NULL)) as clne_close,
    MAX(IF(s.symbol='CLNE', y.rsi_14, NULL)) as clne_rsi_14,
    MAX(IF(s.symbol='CLNE', y.ma_30d, NULL)) as clne_ma_30d,
    MAX(IF(s.symbol='CLNE', y.macd_line, NULL)) as clne_macd,
    MAX(IF(s.symbol='CLNE', y.atr_14, NULL)) as clne_atr,
    MAX(IF(s.symbol='CLNE', y.bb_upper, NULL)) as clne_bb_upper,
    MAX(IF(s.symbol='CLNE', y.momentum_10, NULL)) as clne_momentum,
    MAX(IF(s.symbol='CNHI', y.close, NULL)) as cnhi_close,
    MAX(IF(s.symbol='CNHI', y.rsi_14, NULL)) as cnhi_rsi_14,
    MAX(IF(s.symbol='CNHI', y.ma_30d, NULL)) as cnhi_ma_30d,
    MAX(IF(s.symbol='CNHI', y.macd_line, NULL)) as cnhi_macd,
    MAX(IF(s.symbol='CNHI', y.atr_14, NULL)) as cnhi_atr,
    MAX(IF(s.symbol='CNHI', y.bb_upper, NULL)) as cnhi_bb_upper,
    MAX(IF(s.symbol='CNHI', y.momentum_10, NULL)) as cnhi_momentum,
    MAX(IF(s.symbol='CNRG', y.close, NULL)) as cnrg_close,
    MAX(IF(s.symbol='CNRG', y.rsi_14, NULL)) as cnrg_rsi_14,
    MAX(IF(s.symbol='CNRG', y.ma_30d, NULL)) as cnrg_ma_30d,
    MAX(IF(s.symbol='CNRG', y.macd_line, NULL)) as cnrg_macd,
    MAX(IF(s.symbol='CNRG', y.atr_14, NULL)) as cnrg_atr,
    MAX(IF(s.symbol='CNRG', y.bb_upper, NULL)) as cnrg_bb_upper,
    MAX(IF(s.symbol='CNRG', y.momentum_10, NULL)) as cnrg_momentum,
    MAX(IF(s.symbol='CNYUSD=X', y.close, NULL)) as cnyusd_x_close,
    MAX(IF(s.symbol='CNYUSD=X', y.rsi_14, NULL)) as cnyusd_x_rsi_14,
    MAX(IF(s.symbol='CNYUSD=X', y.ma_30d, NULL)) as cnyusd_x_ma_30d,
    MAX(IF(s.symbol='CNYUSD=X', y.macd_line, NULL)) as cnyusd_x_macd,
    MAX(IF(s.symbol='CNYUSD=X', y.atr_14, NULL)) as cnyusd_x_atr,
    MAX(IF(s.symbol='CNYUSD=X', y.bb_upper, NULL)) as cnyusd_x_bb_upper,
    MAX(IF(s.symbol='CNYUSD=X', y.momentum_10, NULL)) as cnyusd_x_momentum,
    MAX(IF(s.symbol='COP', y.close, NULL)) as cop_close,
    MAX(IF(s.symbol='COP', y.rsi_14, NULL)) as cop_rsi_14,
    MAX(IF(s.symbol='COP', y.ma_30d, NULL)) as cop_ma_30d,
    MAX(IF(s.symbol='COP', y.macd_line, NULL)) as cop_macd,
    MAX(IF(s.symbol='COP', y.atr_14, NULL)) as cop_atr,
    MAX(IF(s.symbol='COP', y.bb_upper, NULL)) as cop_bb_upper,
    MAX(IF(s.symbol='COP', y.momentum_10, NULL)) as cop_momentum,
    MAX(IF(s.symbol='COPX', y.close, NULL)) as copx_close,
    MAX(IF(s.symbol='COPX', y.rsi_14, NULL)) as copx_rsi_14,
    MAX(IF(s.symbol='COPX', y.ma_30d, NULL)) as copx_ma_30d,
    MAX(IF(s.symbol='COPX', y.macd_line, NULL)) as copx_macd,
    MAX(IF(s.symbol='COPX', y.atr_14, NULL)) as copx_atr,
    MAX(IF(s.symbol='COPX', y.bb_upper, NULL)) as copx_bb_upper,
    MAX(IF(s.symbol='COPX', y.momentum_10, NULL)) as copx_momentum,
    MAX(IF(s.symbol='CORN', y.close, NULL)) as corn_close_yh,
    MAX(IF(s.symbol='CORN', y.rsi_14, NULL)) as corn_rsi_14_yh,
    MAX(IF(s.symbol='CORN', y.ma_30d, NULL)) as corn_ma_30d_yh,
    MAX(IF(s.symbol='CORN', y.macd_line, NULL)) as corn_macd_yh,
    MAX(IF(s.symbol='CORN', y.atr_14, NULL)) as corn_atr_yh,
    MAX(IF(s.symbol='CORN', y.bb_upper, NULL)) as corn_bb_upper_yh,
    MAX(IF(s.symbol='CORN', y.momentum_10, NULL)) as corn_momentum_yh,
    MAX(IF(s.symbol='COW', y.close, NULL)) as cow_close,
    MAX(IF(s.symbol='COW', y.rsi_14, NULL)) as cow_rsi_14,
    MAX(IF(s.symbol='COW', y.ma_30d, NULL)) as cow_ma_30d,
    MAX(IF(s.symbol='COW', y.macd_line, NULL)) as cow_macd,
    MAX(IF(s.symbol='COW', y.atr_14, NULL)) as cow_atr,
    MAX(IF(s.symbol='COW', y.bb_upper, NULL)) as cow_bb_upper,
    MAX(IF(s.symbol='COW', y.momentum_10, NULL)) as cow_momentum,
    MAX(IF(s.symbol='CPB', y.close, NULL)) as cpb_close,
    MAX(IF(s.symbol='CPB', y.rsi_14, NULL)) as cpb_rsi_14,
    MAX(IF(s.symbol='CPB', y.ma_30d, NULL)) as cpb_ma_30d,
    MAX(IF(s.symbol='CPB', y.macd_line, NULL)) as cpb_macd,
    MAX(IF(s.symbol='CPB', y.atr_14, NULL)) as cpb_atr,
    MAX(IF(s.symbol='CPB', y.bb_upper, NULL)) as cpb_bb_upper,
    MAX(IF(s.symbol='CPB', y.momentum_10, NULL)) as cpb_momentum,
    MAX(IF(s.symbol='CRESY', y.close, NULL)) as cresy_close,
    MAX(IF(s.symbol='CRESY', y.rsi_14, NULL)) as cresy_rsi_14,
    MAX(IF(s.symbol='CRESY', y.ma_30d, NULL)) as cresy_ma_30d,
    MAX(IF(s.symbol='CRESY', y.macd_line, NULL)) as cresy_macd,
    MAX(IF(s.symbol='CRESY', y.atr_14, NULL)) as cresy_atr,
    MAX(IF(s.symbol='CRESY', y.bb_upper, NULL)) as cresy_bb_upper,
    MAX(IF(s.symbol='CRESY', y.momentum_10, NULL)) as cresy_momentum,
    MAX(IF(s.symbol='CT=F', y.close, NULL)) as ct_f_close,
    MAX(IF(s.symbol='CT=F', y.rsi_14, NULL)) as ct_f_rsi_14,
    MAX(IF(s.symbol='CT=F', y.ma_30d, NULL)) as ct_f_ma_30d,
    MAX(IF(s.symbol='CT=F', y.macd_line, NULL)) as ct_f_macd,
    MAX(IF(s.symbol='CT=F', y.atr_14, NULL)) as ct_f_atr,
    MAX(IF(s.symbol='CT=F', y.bb_upper, NULL)) as ct_f_bb_upper,
    MAX(IF(s.symbol='CT=F', y.momentum_10, NULL)) as ct_f_momentum,
    MAX(IF(s.symbol='CTVA', y.close, NULL)) as ctva_close,
    MAX(IF(s.symbol='CTVA', y.rsi_14, NULL)) as ctva_rsi_14,
    MAX(IF(s.symbol='CTVA', y.ma_30d, NULL)) as ctva_ma_30d,
    MAX(IF(s.symbol='CTVA', y.macd_line, NULL)) as ctva_macd,
    MAX(IF(s.symbol='CTVA', y.atr_14, NULL)) as ctva_atr,
    MAX(IF(s.symbol='CTVA', y.bb_upper, NULL)) as ctva_bb_upper,
    MAX(IF(s.symbol='CTVA', y.momentum_10, NULL)) as ctva_momentum,
    MAX(IF(s.symbol='CVGW', y.close, NULL)) as cvgw_close,
    MAX(IF(s.symbol='CVGW', y.rsi_14, NULL)) as cvgw_rsi_14,
    MAX(IF(s.symbol='CVGW', y.ma_30d, NULL)) as cvgw_ma_30d,
    MAX(IF(s.symbol='CVGW', y.macd_line, NULL)) as cvgw_macd,
    MAX(IF(s.symbol='CVGW', y.atr_14, NULL)) as cvgw_atr,
    MAX(IF(s.symbol='CVGW', y.bb_upper, NULL)) as cvgw_bb_upper,
    MAX(IF(s.symbol='CVGW', y.momentum_10, NULL)) as cvgw_momentum,
    MAX(IF(s.symbol='CVX', y.close, NULL)) as cvx_close,
    MAX(IF(s.symbol='CVX', y.rsi_14, NULL)) as cvx_rsi_14,
    MAX(IF(s.symbol='CVX', y.ma_30d, NULL)) as cvx_ma_30d,
    MAX(IF(s.symbol='CVX', y.macd_line, NULL)) as cvx_macd,
    MAX(IF(s.symbol='CVX', y.atr_14, NULL)) as cvx_atr,
    MAX(IF(s.symbol='CVX', y.bb_upper, NULL)) as cvx_bb_upper,
    MAX(IF(s.symbol='CVX', y.momentum_10, NULL)) as cvx_momentum,
    MAX(IF(s.symbol='CYB', y.close, NULL)) as cyb_close,
    MAX(IF(s.symbol='CYB', y.rsi_14, NULL)) as cyb_rsi_14,
    MAX(IF(s.symbol='CYB', y.ma_30d, NULL)) as cyb_ma_30d,
    MAX(IF(s.symbol='CYB', y.macd_line, NULL)) as cyb_macd,
    MAX(IF(s.symbol='CYB', y.atr_14, NULL)) as cyb_atr,
    MAX(IF(s.symbol='CYB', y.bb_upper, NULL)) as cyb_bb_upper,
    MAX(IF(s.symbol='CYB', y.momentum_10, NULL)) as cyb_momentum,
    MAX(IF(s.symbol='DAR', y.close, NULL)) as dar_close_yh,
    MAX(IF(s.symbol='DAR', y.rsi_14, NULL)) as dar_rsi_14_yh,
    MAX(IF(s.symbol='DAR', y.ma_30d, NULL)) as dar_ma_30d_yh,
    MAX(IF(s.symbol='DAR', y.macd_line, NULL)) as dar_macd_yh,
    MAX(IF(s.symbol='DAR', y.atr_14, NULL)) as dar_atr_yh,
    MAX(IF(s.symbol='DAR', y.bb_upper, NULL)) as dar_bb_upper_yh,
    MAX(IF(s.symbol='DAR', y.momentum_10, NULL)) as dar_momentum_yh,
    MAX(IF(s.symbol='DBA', y.close, NULL)) as dba_close,
    MAX(IF(s.symbol='DBA', y.rsi_14, NULL)) as dba_rsi_14,
    MAX(IF(s.symbol='DBA', y.ma_30d, NULL)) as dba_ma_30d,
    MAX(IF(s.symbol='DBA', y.macd_line, NULL)) as dba_macd,
    MAX(IF(s.symbol='DBA', y.atr_14, NULL)) as dba_atr,
    MAX(IF(s.symbol='DBA', y.bb_upper, NULL)) as dba_bb_upper,
    MAX(IF(s.symbol='DBA', y.momentum_10, NULL)) as dba_momentum,
    MAX(IF(s.symbol='DBB', y.close, NULL)) as dbb_close,
    MAX(IF(s.symbol='DBB', y.rsi_14, NULL)) as dbb_rsi_14,
    MAX(IF(s.symbol='DBB', y.ma_30d, NULL)) as dbb_ma_30d,
    MAX(IF(s.symbol='DBB', y.macd_line, NULL)) as dbb_macd,
    MAX(IF(s.symbol='DBB', y.atr_14, NULL)) as dbb_atr,
    MAX(IF(s.symbol='DBB', y.bb_upper, NULL)) as dbb_bb_upper,
    MAX(IF(s.symbol='DBB', y.momentum_10, NULL)) as dbb_momentum,
    MAX(IF(s.symbol='DBV', y.close, NULL)) as dbv_close,
    MAX(IF(s.symbol='DBV', y.rsi_14, NULL)) as dbv_rsi_14,
    MAX(IF(s.symbol='DBV', y.ma_30d, NULL)) as dbv_ma_30d,
    MAX(IF(s.symbol='DBV', y.macd_line, NULL)) as dbv_macd,
    MAX(IF(s.symbol='DBV', y.atr_14, NULL)) as dbv_atr,
    MAX(IF(s.symbol='DBV', y.bb_upper, NULL)) as dbv_bb_upper,
    MAX(IF(s.symbol='DBV', y.momentum_10, NULL)) as dbv_momentum,
    MAX(IF(s.symbol='DC=F', y.close, NULL)) as dc_f_close,
    MAX(IF(s.symbol='DC=F', y.rsi_14, NULL)) as dc_f_rsi_14,
    MAX(IF(s.symbol='DC=F', y.ma_30d, NULL)) as dc_f_ma_30d,
    MAX(IF(s.symbol='DC=F', y.macd_line, NULL)) as dc_f_macd,
    MAX(IF(s.symbol='DC=F', y.atr_14, NULL)) as dc_f_atr,
    MAX(IF(s.symbol='DC=F', y.bb_upper, NULL)) as dc_f_bb_upper,
    MAX(IF(s.symbol='DC=F', y.momentum_10, NULL)) as dc_f_momentum,
    MAX(IF(s.symbol='DE', y.close, NULL)) as de_close,
    MAX(IF(s.symbol='DE', y.rsi_14, NULL)) as de_rsi_14,
    MAX(IF(s.symbol='DE', y.ma_30d, NULL)) as de_ma_30d,
    MAX(IF(s.symbol='DE', y.macd_line, NULL)) as de_macd,
    MAX(IF(s.symbol='DE', y.atr_14, NULL)) as de_atr,
    MAX(IF(s.symbol='DE', y.bb_upper, NULL)) as de_bb_upper,
    MAX(IF(s.symbol='DE', y.momentum_10, NULL)) as de_momentum,
    MAX(IF(s.symbol='DX-Y.NYB', y.close, NULL)) as dx_y_nyb_close,
    MAX(IF(s.symbol='DX-Y.NYB', y.rsi_14, NULL)) as dx_y_nyb_rsi_14,
    MAX(IF(s.symbol='DX-Y.NYB', y.ma_30d, NULL)) as dx_y_nyb_ma_30d,
    MAX(IF(s.symbol='DX-Y.NYB', y.macd_line, NULL)) as dx_y_nyb_macd,
    MAX(IF(s.symbol='DX-Y.NYB', y.atr_14, NULL)) as dx_y_nyb_atr,
    MAX(IF(s.symbol='DX-Y.NYB', y.bb_upper, NULL)) as dx_y_nyb_bb_upper,
    MAX(IF(s.symbol='DX-Y.NYB', y.momentum_10, NULL)) as dx_y_nyb_momentum,
    MAX(IF(s.symbol='DXY', y.close, NULL)) as dxy_close_yh,
    MAX(IF(s.symbol='DXY', y.rsi_14, NULL)) as dxy_rsi_14_yh,
    MAX(IF(s.symbol='DXY', y.ma_30d, NULL)) as dxy_ma_30d_yh,
    MAX(IF(s.symbol='DXY', y.macd_line, NULL)) as dxy_macd_yh,
    MAX(IF(s.symbol='DXY', y.atr_14, NULL)) as dxy_atr_yh,
    MAX(IF(s.symbol='DXY', y.bb_upper, NULL)) as dxy_bb_upper_yh,
    MAX(IF(s.symbol='DXY', y.momentum_10, NULL)) as dxy_momentum_yh,
    MAX(IF(s.symbol='DY=F', y.close, NULL)) as dy_f_close,
    MAX(IF(s.symbol='DY=F', y.rsi_14, NULL)) as dy_f_rsi_14,
    MAX(IF(s.symbol='DY=F', y.ma_30d, NULL)) as dy_f_ma_30d,
    MAX(IF(s.symbol='DY=F', y.macd_line, NULL)) as dy_f_macd,
    MAX(IF(s.symbol='DY=F', y.atr_14, NULL)) as dy_f_atr,
    MAX(IF(s.symbol='DY=F', y.bb_upper, NULL)) as dy_f_bb_upper,
    MAX(IF(s.symbol='DY=F', y.momentum_10, NULL)) as dy_f_momentum,
    MAX(IF(s.symbol='EEM', y.close, NULL)) as eem_close,
    MAX(IF(s.symbol='EEM', y.rsi_14, NULL)) as eem_rsi_14,
    MAX(IF(s.symbol='EEM', y.ma_30d, NULL)) as eem_ma_30d,
    MAX(IF(s.symbol='EEM', y.macd_line, NULL)) as eem_macd,
    MAX(IF(s.symbol='EEM', y.atr_14, NULL)) as eem_atr,
    MAX(IF(s.symbol='EEM', y.bb_upper, NULL)) as eem_bb_upper,
    MAX(IF(s.symbol='EEM', y.momentum_10, NULL)) as eem_momentum,
    MAX(IF(s.symbol='EGLE', y.close, NULL)) as egle_close,
    MAX(IF(s.symbol='EGLE', y.rsi_14, NULL)) as egle_rsi_14,
    MAX(IF(s.symbol='EGLE', y.ma_30d, NULL)) as egle_ma_30d,
    MAX(IF(s.symbol='EGLE', y.macd_line, NULL)) as egle_macd,
    MAX(IF(s.symbol='EGLE', y.atr_14, NULL)) as egle_atr,
    MAX(IF(s.symbol='EGLE', y.bb_upper, NULL)) as egle_bb_upper,
    MAX(IF(s.symbol='EGLE', y.momentum_10, NULL)) as egle_momentum,
    MAX(IF(s.symbol='EMB', y.close, NULL)) as emb_close,
    MAX(IF(s.symbol='EMB', y.rsi_14, NULL)) as emb_rsi_14,
    MAX(IF(s.symbol='EMB', y.ma_30d, NULL)) as emb_ma_30d,
    MAX(IF(s.symbol='EMB', y.macd_line, NULL)) as emb_macd,
    MAX(IF(s.symbol='EMB', y.atr_14, NULL)) as emb_atr,
    MAX(IF(s.symbol='EMB', y.bb_upper, NULL)) as emb_bb_upper,
    MAX(IF(s.symbol='EMB', y.momentum_10, NULL)) as emb_momentum,
    MAX(IF(s.symbol='EMHY', y.close, NULL)) as emhy_close,
    MAX(IF(s.symbol='EMHY', y.rsi_14, NULL)) as emhy_rsi_14,
    MAX(IF(s.symbol='EMHY', y.ma_30d, NULL)) as emhy_ma_30d,
    MAX(IF(s.symbol='EMHY', y.macd_line, NULL)) as emhy_macd,
    MAX(IF(s.symbol='EMHY', y.atr_14, NULL)) as emhy_atr,
    MAX(IF(s.symbol='EMHY', y.bb_upper, NULL)) as emhy_bb_upper,
    MAX(IF(s.symbol='EMHY', y.momentum_10, NULL)) as emhy_momentum,
    MAX(IF(s.symbol='ENPH', y.close, NULL)) as enph_close,
    MAX(IF(s.symbol='ENPH', y.rsi_14, NULL)) as enph_rsi_14,
    MAX(IF(s.symbol='ENPH', y.ma_30d, NULL)) as enph_ma_30d,
    MAX(IF(s.symbol='ENPH', y.macd_line, NULL)) as enph_macd,
    MAX(IF(s.symbol='ENPH', y.atr_14, NULL)) as enph_atr,
    MAX(IF(s.symbol='ENPH', y.bb_upper, NULL)) as enph_bb_upper,
    MAX(IF(s.symbol='ENPH', y.momentum_10, NULL)) as enph_momentum,
    MAX(IF(s.symbol='EOG', y.close, NULL)) as eog_close,
    MAX(IF(s.symbol='EOG', y.rsi_14, NULL)) as eog_rsi_14,
    MAX(IF(s.symbol='EOG', y.ma_30d, NULL)) as eog_ma_30d,
    MAX(IF(s.symbol='EOG', y.macd_line, NULL)) as eog_macd,
    MAX(IF(s.symbol='EOG', y.atr_14, NULL)) as eog_atr,
    MAX(IF(s.symbol='EOG', y.bb_upper, NULL)) as eog_bb_upper,
    MAX(IF(s.symbol='EOG', y.momentum_10, NULL)) as eog_momentum,
    MAX(IF(s.symbol='EURUSD=X', y.close, NULL)) as eurusd_x_close,
    MAX(IF(s.symbol='EURUSD=X', y.rsi_14, NULL)) as eurusd_x_rsi_14,
    MAX(IF(s.symbol='EURUSD=X', y.ma_30d, NULL)) as eurusd_x_ma_30d,
    MAX(IF(s.symbol='EURUSD=X', y.macd_line, NULL)) as eurusd_x_macd,
    MAX(IF(s.symbol='EURUSD=X', y.atr_14, NULL)) as eurusd_x_atr,
    MAX(IF(s.symbol='EURUSD=X', y.bb_upper, NULL)) as eurusd_x_bb_upper,
    MAX(IF(s.symbol='EURUSD=X', y.momentum_10, NULL)) as eurusd_x_momentum,
    MAX(IF(s.symbol='EWZ', y.close, NULL)) as ewz_close,
    MAX(IF(s.symbol='EWZ', y.rsi_14, NULL)) as ewz_rsi_14,
    MAX(IF(s.symbol='EWZ', y.ma_30d, NULL)) as ewz_ma_30d,
    MAX(IF(s.symbol='EWZ', y.macd_line, NULL)) as ewz_macd,
    MAX(IF(s.symbol='EWZ', y.atr_14, NULL)) as ewz_atr,
    MAX(IF(s.symbol='EWZ', y.bb_upper, NULL)) as ewz_bb_upper,
    MAX(IF(s.symbol='EWZ', y.momentum_10, NULL)) as ewz_momentum,
    MAX(IF(s.symbol='FALN', y.close, NULL)) as faln_close,
    MAX(IF(s.symbol='FALN', y.rsi_14, NULL)) as faln_rsi_14,
    MAX(IF(s.symbol='FALN', y.ma_30d, NULL)) as faln_ma_30d,
    MAX(IF(s.symbol='FALN', y.macd_line, NULL)) as faln_macd,
    MAX(IF(s.symbol='FALN', y.atr_14, NULL)) as faln_atr,
    MAX(IF(s.symbol='FALN', y.bb_upper, NULL)) as faln_bb_upper,
    MAX(IF(s.symbol='FALN', y.momentum_10, NULL)) as faln_momentum,
    MAX(IF(s.symbol='FCEL', y.close, NULL)) as fcel_close,
    MAX(IF(s.symbol='FCEL', y.rsi_14, NULL)) as fcel_rsi_14,
    MAX(IF(s.symbol='FCEL', y.ma_30d, NULL)) as fcel_ma_30d,
    MAX(IF(s.symbol='FCEL', y.macd_line, NULL)) as fcel_macd,
    MAX(IF(s.symbol='FCEL', y.atr_14, NULL)) as fcel_atr,
    MAX(IF(s.symbol='FCEL', y.bb_upper, NULL)) as fcel_bb_upper,
    MAX(IF(s.symbol='FCEL', y.momentum_10, NULL)) as fcel_momentum,
    MAX(IF(s.symbol='FDP', y.close, NULL)) as fdp_close,
    MAX(IF(s.symbol='FDP', y.rsi_14, NULL)) as fdp_rsi_14,
    MAX(IF(s.symbol='FDP', y.ma_30d, NULL)) as fdp_ma_30d,
    MAX(IF(s.symbol='FDP', y.macd_line, NULL)) as fdp_macd,
    MAX(IF(s.symbol='FDP', y.atr_14, NULL)) as fdp_atr,
    MAX(IF(s.symbol='FDP', y.bb_upper, NULL)) as fdp_bb_upper,
    MAX(IF(s.symbol='FDP', y.momentum_10, NULL)) as fdp_momentum,
    MAX(IF(s.symbol='FXA', y.close, NULL)) as fxa_close,
    MAX(IF(s.symbol='FXA', y.rsi_14, NULL)) as fxa_rsi_14,
    MAX(IF(s.symbol='FXA', y.ma_30d, NULL)) as fxa_ma_30d,
    MAX(IF(s.symbol='FXA', y.macd_line, NULL)) as fxa_macd,
    MAX(IF(s.symbol='FXA', y.atr_14, NULL)) as fxa_atr,
    MAX(IF(s.symbol='FXA', y.bb_upper, NULL)) as fxa_bb_upper,
    MAX(IF(s.symbol='FXA', y.momentum_10, NULL)) as fxa_momentum,
    MAX(IF(s.symbol='FXC', y.close, NULL)) as fxc_close,
    MAX(IF(s.symbol='FXC', y.rsi_14, NULL)) as fxc_rsi_14,
    MAX(IF(s.symbol='FXC', y.ma_30d, NULL)) as fxc_ma_30d,
    MAX(IF(s.symbol='FXC', y.macd_line, NULL)) as fxc_macd,
    MAX(IF(s.symbol='FXC', y.atr_14, NULL)) as fxc_atr,
    MAX(IF(s.symbol='FXC', y.bb_upper, NULL)) as fxc_bb_upper,
    MAX(IF(s.symbol='FXC', y.momentum_10, NULL)) as fxc_momentum,
    MAX(IF(s.symbol='FXE', y.close, NULL)) as fxe_close,
    MAX(IF(s.symbol='FXE', y.rsi_14, NULL)) as fxe_rsi_14,
    MAX(IF(s.symbol='FXE', y.ma_30d, NULL)) as fxe_ma_30d,
    MAX(IF(s.symbol='FXE', y.macd_line, NULL)) as fxe_macd,
    MAX(IF(s.symbol='FXE', y.atr_14, NULL)) as fxe_atr,
    MAX(IF(s.symbol='FXE', y.bb_upper, NULL)) as fxe_bb_upper,
    MAX(IF(s.symbol='FXE', y.momentum_10, NULL)) as fxe_momentum,
    MAX(IF(s.symbol='FXI', y.close, NULL)) as fxi_close,
    MAX(IF(s.symbol='FXI', y.rsi_14, NULL)) as fxi_rsi_14,
    MAX(IF(s.symbol='FXI', y.ma_30d, NULL)) as fxi_ma_30d,
    MAX(IF(s.symbol='FXI', y.macd_line, NULL)) as fxi_macd,
    MAX(IF(s.symbol='FXI', y.atr_14, NULL)) as fxi_atr,
    MAX(IF(s.symbol='FXI', y.bb_upper, NULL)) as fxi_bb_upper,
    MAX(IF(s.symbol='FXI', y.momentum_10, NULL)) as fxi_momentum,
    MAX(IF(s.symbol='FXY', y.close, NULL)) as fxy_close,
    MAX(IF(s.symbol='FXY', y.rsi_14, NULL)) as fxy_rsi_14,
    MAX(IF(s.symbol='FXY', y.ma_30d, NULL)) as fxy_ma_30d,
    MAX(IF(s.symbol='FXY', y.macd_line, NULL)) as fxy_macd,
    MAX(IF(s.symbol='FXY', y.atr_14, NULL)) as fxy_atr,
    MAX(IF(s.symbol='FXY', y.bb_upper, NULL)) as fxy_bb_upper,
    MAX(IF(s.symbol='FXY', y.momentum_10, NULL)) as fxy_momentum,
    MAX(IF(s.symbol='GBPUSD=X', y.close, NULL)) as gbpusd_x_close,
    MAX(IF(s.symbol='GBPUSD=X', y.rsi_14, NULL)) as gbpusd_x_rsi_14,
    MAX(IF(s.symbol='GBPUSD=X', y.ma_30d, NULL)) as gbpusd_x_ma_30d,
    MAX(IF(s.symbol='GBPUSD=X', y.macd_line, NULL)) as gbpusd_x_macd,
    MAX(IF(s.symbol='GBPUSD=X', y.atr_14, NULL)) as gbpusd_x_atr,
    MAX(IF(s.symbol='GBPUSD=X', y.bb_upper, NULL)) as gbpusd_x_bb_upper,
    MAX(IF(s.symbol='GBPUSD=X', y.momentum_10, NULL)) as gbpusd_x_momentum,
    MAX(IF(s.symbol='GC=F', y.close, NULL)) as gc_f_close,
    MAX(IF(s.symbol='GC=F', y.rsi_14, NULL)) as gc_f_rsi_14,
    MAX(IF(s.symbol='GC=F', y.ma_30d, NULL)) as gc_f_ma_30d,
    MAX(IF(s.symbol='GC=F', y.macd_line, NULL)) as gc_f_macd,
    MAX(IF(s.symbol='GC=F', y.atr_14, NULL)) as gc_f_atr,
    MAX(IF(s.symbol='GC=F', y.bb_upper, NULL)) as gc_f_bb_upper,
    MAX(IF(s.symbol='GC=F', y.momentum_10, NULL)) as gc_f_momentum,
    MAX(IF(s.symbol='GEVO', y.close, NULL)) as gevo_close,
    MAX(IF(s.symbol='GEVO', y.rsi_14, NULL)) as gevo_rsi_14,
    MAX(IF(s.symbol='GEVO', y.ma_30d, NULL)) as gevo_ma_30d,
    MAX(IF(s.symbol='GEVO', y.macd_line, NULL)) as gevo_macd,
    MAX(IF(s.symbol='GEVO', y.atr_14, NULL)) as gevo_atr,
    MAX(IF(s.symbol='GEVO', y.bb_upper, NULL)) as gevo_bb_upper,
    MAX(IF(s.symbol='GEVO', y.momentum_10, NULL)) as gevo_momentum,
    MAX(IF(s.symbol='GF=F', y.close, NULL)) as gf_f_close,
    MAX(IF(s.symbol='GF=F', y.rsi_14, NULL)) as gf_f_rsi_14,
    MAX(IF(s.symbol='GF=F', y.ma_30d, NULL)) as gf_f_ma_30d,
    MAX(IF(s.symbol='GF=F', y.macd_line, NULL)) as gf_f_macd,
    MAX(IF(s.symbol='GF=F', y.atr_14, NULL)) as gf_f_atr,
    MAX(IF(s.symbol='GF=F', y.bb_upper, NULL)) as gf_f_bb_upper,
    MAX(IF(s.symbol='GF=F', y.momentum_10, NULL)) as gf_f_momentum,
    MAX(IF(s.symbol='GIS', y.close, NULL)) as gis_close,
    MAX(IF(s.symbol='GIS', y.rsi_14, NULL)) as gis_rsi_14,
    MAX(IF(s.symbol='GIS', y.ma_30d, NULL)) as gis_ma_30d,
    MAX(IF(s.symbol='GIS', y.macd_line, NULL)) as gis_macd,
    MAX(IF(s.symbol='GIS', y.atr_14, NULL)) as gis_atr,
    MAX(IF(s.symbol='GIS', y.bb_upper, NULL)) as gis_bb_upper,
    MAX(IF(s.symbol='GIS', y.momentum_10, NULL)) as gis_momentum,
    MAX(IF(s.symbol='GLD', y.close, NULL)) as gld_close,
    MAX(IF(s.symbol='GLD', y.rsi_14, NULL)) as gld_rsi_14,
    MAX(IF(s.symbol='GLD', y.ma_30d, NULL)) as gld_ma_30d,
    MAX(IF(s.symbol='GLD', y.macd_line, NULL)) as gld_macd,
    MAX(IF(s.symbol='GLD', y.atr_14, NULL)) as gld_atr,
    MAX(IF(s.symbol='GLD', y.bb_upper, NULL)) as gld_bb_upper,
    MAX(IF(s.symbol='GLD', y.momentum_10, NULL)) as gld_momentum,
    MAX(IF(s.symbol='GOGL', y.close, NULL)) as gogl_close,
    MAX(IF(s.symbol='GOGL', y.rsi_14, NULL)) as gogl_rsi_14,
    MAX(IF(s.symbol='GOGL', y.ma_30d, NULL)) as gogl_ma_30d,
    MAX(IF(s.symbol='GOGL', y.macd_line, NULL)) as gogl_macd,
    MAX(IF(s.symbol='GOGL', y.atr_14, NULL)) as gogl_atr,
    MAX(IF(s.symbol='GOGL', y.bb_upper, NULL)) as gogl_bb_upper,
    MAX(IF(s.symbol='GOGL', y.momentum_10, NULL)) as gogl_momentum,
    MAX(IF(s.symbol='HE=F', y.close, NULL)) as he_f_close,
    MAX(IF(s.symbol='HE=F', y.rsi_14, NULL)) as he_f_rsi_14,
    MAX(IF(s.symbol='HE=F', y.ma_30d, NULL)) as he_f_ma_30d,
    MAX(IF(s.symbol='HE=F', y.macd_line, NULL)) as he_f_macd,
    MAX(IF(s.symbol='HE=F', y.atr_14, NULL)) as he_f_atr,
    MAX(IF(s.symbol='HE=F', y.bb_upper, NULL)) as he_f_bb_upper,
    MAX(IF(s.symbol='HE=F', y.momentum_10, NULL)) as he_f_momentum,
    MAX(IF(s.symbol='HG=F', y.close, NULL)) as hg_f_close,
    MAX(IF(s.symbol='HG=F', y.rsi_14, NULL)) as hg_f_rsi_14,
    MAX(IF(s.symbol='HG=F', y.ma_30d, NULL)) as hg_f_ma_30d,
    MAX(IF(s.symbol='HG=F', y.macd_line, NULL)) as hg_f_macd,
    MAX(IF(s.symbol='HG=F', y.atr_14, NULL)) as hg_f_atr,
    MAX(IF(s.symbol='HG=F', y.bb_upper, NULL)) as hg_f_bb_upper,
    MAX(IF(s.symbol='HG=F', y.momentum_10, NULL)) as hg_f_momentum,
    MAX(IF(s.symbol='HO=F', y.close, NULL)) as ho_f_close_yh,
    MAX(IF(s.symbol='HO=F', y.rsi_14, NULL)) as ho_f_rsi_14_yh,
    MAX(IF(s.symbol='HO=F', y.ma_30d, NULL)) as ho_f_ma_30d_yh,
    MAX(IF(s.symbol='HO=F', y.macd_line, NULL)) as ho_f_macd_yh,
    MAX(IF(s.symbol='HO=F', y.atr_14, NULL)) as ho_f_atr_yh,
    MAX(IF(s.symbol='HO=F', y.bb_upper, NULL)) as ho_f_bb_upper_yh,
    MAX(IF(s.symbol='HO=F', y.momentum_10, NULL)) as ho_f_momentum_yh,
    MAX(IF(s.symbol='HRL', y.close, NULL)) as hrl_close,
    MAX(IF(s.symbol='HRL', y.rsi_14, NULL)) as hrl_rsi_14,
    MAX(IF(s.symbol='HRL', y.ma_30d, NULL)) as hrl_ma_30d,
    MAX(IF(s.symbol='HRL', y.macd_line, NULL)) as hrl_macd,
    MAX(IF(s.symbol='HRL', y.atr_14, NULL)) as hrl_atr,
    MAX(IF(s.symbol='HRL', y.bb_upper, NULL)) as hrl_bb_upper,
    MAX(IF(s.symbol='HRL', y.momentum_10, NULL)) as hrl_momentum,
    MAX(IF(s.symbol='HYG', y.close, NULL)) as hyg_close_yh,
    MAX(IF(s.symbol='HYG', y.rsi_14, NULL)) as hyg_rsi_14_yh,
    MAX(IF(s.symbol='HYG', y.ma_30d, NULL)) as hyg_ma_30d_yh,
    MAX(IF(s.symbol='HYG', y.macd_line, NULL)) as hyg_macd_yh,
    MAX(IF(s.symbol='HYG', y.atr_14, NULL)) as hyg_atr_yh,
    MAX(IF(s.symbol='HYG', y.bb_upper, NULL)) as hyg_bb_upper_yh,
    MAX(IF(s.symbol='HYG', y.momentum_10, NULL)) as hyg_momentum_yh,
    MAX(IF(s.symbol='ICLN', y.close, NULL)) as icln_close,
    MAX(IF(s.symbol='ICLN', y.rsi_14, NULL)) as icln_rsi_14,
    MAX(IF(s.symbol='ICLN', y.ma_30d, NULL)) as icln_ma_30d,
    MAX(IF(s.symbol='ICLN', y.macd_line, NULL)) as icln_macd,
    MAX(IF(s.symbol='ICLN', y.atr_14, NULL)) as icln_atr,
    MAX(IF(s.symbol='ICLN', y.bb_upper, NULL)) as icln_bb_upper,
    MAX(IF(s.symbol='ICLN', y.momentum_10, NULL)) as icln_momentum,
    MAX(IF(s.symbol='IDRRUSD=X', y.close, NULL)) as idrrusd_x_close,
    MAX(IF(s.symbol='IDRRUSD=X', y.rsi_14, NULL)) as idrrusd_x_rsi_14,
    MAX(IF(s.symbol='IDRRUSD=X', y.ma_30d, NULL)) as idrrusd_x_ma_30d,
    MAX(IF(s.symbol='IDRRUSD=X', y.macd_line, NULL)) as idrrusd_x_macd,
    MAX(IF(s.symbol='IDRRUSD=X', y.atr_14, NULL)) as idrrusd_x_atr,
    MAX(IF(s.symbol='IDRRUSD=X', y.bb_upper, NULL)) as idrrusd_x_bb_upper,
    MAX(IF(s.symbol='IDRRUSD=X', y.momentum_10, NULL)) as idrrusd_x_momentum,
    MAX(IF(s.symbol='IEF', y.close, NULL)) as ief_close,
    MAX(IF(s.symbol='IEF', y.rsi_14, NULL)) as ief_rsi_14,
    MAX(IF(s.symbol='IEF', y.ma_30d, NULL)) as ief_ma_30d,
    MAX(IF(s.symbol='IEF', y.macd_line, NULL)) as ief_macd,
    MAX(IF(s.symbol='IEF', y.atr_14, NULL)) as ief_atr,
    MAX(IF(s.symbol='IEF', y.bb_upper, NULL)) as ief_bb_upper,
    MAX(IF(s.symbol='IEF', y.momentum_10, NULL)) as ief_momentum,
    MAX(IF(s.symbol='IEO', y.close, NULL)) as ieo_close,
    MAX(IF(s.symbol='IEO', y.rsi_14, NULL)) as ieo_rsi_14,
    MAX(IF(s.symbol='IEO', y.ma_30d, NULL)) as ieo_ma_30d,
    MAX(IF(s.symbol='IEO', y.macd_line, NULL)) as ieo_macd,
    MAX(IF(s.symbol='IEO', y.atr_14, NULL)) as ieo_atr,
    MAX(IF(s.symbol='IEO', y.bb_upper, NULL)) as ieo_bb_upper,
    MAX(IF(s.symbol='IEO', y.momentum_10, NULL)) as ieo_momentum,
    MAX(IF(s.symbol='INRUSD=X', y.close, NULL)) as inrusd_x_close,
    MAX(IF(s.symbol='INRUSD=X', y.rsi_14, NULL)) as inrusd_x_rsi_14,
    MAX(IF(s.symbol='INRUSD=X', y.ma_30d, NULL)) as inrusd_x_ma_30d,
    MAX(IF(s.symbol='INRUSD=X', y.macd_line, NULL)) as inrusd_x_macd,
    MAX(IF(s.symbol='INRUSD=X', y.atr_14, NULL)) as inrusd_x_atr,
    MAX(IF(s.symbol='INRUSD=X', y.bb_upper, NULL)) as inrusd_x_bb_upper,
    MAX(IF(s.symbol='INRUSD=X', y.momentum_10, NULL)) as inrusd_x_momentum,
    MAX(IF(s.symbol='IXC', y.close, NULL)) as ixc_close,
    MAX(IF(s.symbol='IXC', y.rsi_14, NULL)) as ixc_rsi_14,
    MAX(IF(s.symbol='IXC', y.ma_30d, NULL)) as ixc_ma_30d,
    MAX(IF(s.symbol='IXC', y.macd_line, NULL)) as ixc_macd,
    MAX(IF(s.symbol='IXC', y.atr_14, NULL)) as ixc_atr,
    MAX(IF(s.symbol='IXC', y.bb_upper, NULL)) as ixc_bb_upper,
    MAX(IF(s.symbol='IXC', y.momentum_10, NULL)) as ixc_momentum,
    MAX(IF(s.symbol='JNK', y.close, NULL)) as jnk_close,
    MAX(IF(s.symbol='JNK', y.rsi_14, NULL)) as jnk_rsi_14,
    MAX(IF(s.symbol='JNK', y.ma_30d, NULL)) as jnk_ma_30d,
    MAX(IF(s.symbol='JNK', y.macd_line, NULL)) as jnk_macd,
    MAX(IF(s.symbol='JNK', y.atr_14, NULL)) as jnk_atr,
    MAX(IF(s.symbol='JNK', y.bb_upper, NULL)) as jnk_bb_upper,
    MAX(IF(s.symbol='JNK', y.momentum_10, NULL)) as jnk_momentum,
    MAX(IF(s.symbol='JO', y.close, NULL)) as jo_close,
    MAX(IF(s.symbol='JO', y.rsi_14, NULL)) as jo_rsi_14,
    MAX(IF(s.symbol='JO', y.ma_30d, NULL)) as jo_ma_30d,
    MAX(IF(s.symbol='JO', y.macd_line, NULL)) as jo_macd,
    MAX(IF(s.symbol='JO', y.atr_14, NULL)) as jo_atr,
    MAX(IF(s.symbol='JO', y.bb_upper, NULL)) as jo_bb_upper,
    MAX(IF(s.symbol='JO', y.momentum_10, NULL)) as jo_momentum,
    MAX(IF(s.symbol='JPYUSD=X', y.close, NULL)) as jpyusd_x_close,
    MAX(IF(s.symbol='JPYUSD=X', y.rsi_14, NULL)) as jpyusd_x_rsi_14,
    MAX(IF(s.symbol='JPYUSD=X', y.ma_30d, NULL)) as jpyusd_x_ma_30d,
    MAX(IF(s.symbol='JPYUSD=X', y.macd_line, NULL)) as jpyusd_x_macd,
    MAX(IF(s.symbol='JPYUSD=X', y.atr_14, NULL)) as jpyusd_x_atr,
    MAX(IF(s.symbol='JPYUSD=X', y.bb_upper, NULL)) as jpyusd_x_bb_upper,
    MAX(IF(s.symbol='JPYUSD=X', y.momentum_10, NULL)) as jpyusd_x_momentum,
    MAX(IF(s.symbol='K', y.close, NULL)) as k_close,
    MAX(IF(s.symbol='K', y.rsi_14, NULL)) as k_rsi_14,
    MAX(IF(s.symbol='K', y.ma_30d, NULL)) as k_ma_30d,
    MAX(IF(s.symbol='K', y.macd_line, NULL)) as k_macd,
    MAX(IF(s.symbol='K', y.atr_14, NULL)) as k_atr,
    MAX(IF(s.symbol='K', y.bb_upper, NULL)) as k_bb_upper,
    MAX(IF(s.symbol='K', y.momentum_10, NULL)) as k_momentum,
    MAX(IF(s.symbol='KC=F', y.close, NULL)) as kc_f_close,
    MAX(IF(s.symbol='KC=F', y.rsi_14, NULL)) as kc_f_rsi_14,
    MAX(IF(s.symbol='KC=F', y.ma_30d, NULL)) as kc_f_ma_30d,
    MAX(IF(s.symbol='KC=F', y.macd_line, NULL)) as kc_f_macd,
    MAX(IF(s.symbol='KC=F', y.atr_14, NULL)) as kc_f_atr,
    MAX(IF(s.symbol='KC=F', y.bb_upper, NULL)) as kc_f_bb_upper,
    MAX(IF(s.symbol='KC=F', y.momentum_10, NULL)) as kc_f_momentum,
    MAX(IF(s.symbol='KRWUSD=X', y.close, NULL)) as krwusd_x_close,
    MAX(IF(s.symbol='KRWUSD=X', y.rsi_14, NULL)) as krwusd_x_rsi_14,
    MAX(IF(s.symbol='KRWUSD=X', y.ma_30d, NULL)) as krwusd_x_ma_30d,
    MAX(IF(s.symbol='KRWUSD=X', y.macd_line, NULL)) as krwusd_x_macd,
    MAX(IF(s.symbol='KRWUSD=X', y.atr_14, NULL)) as krwusd_x_atr,
    MAX(IF(s.symbol='KRWUSD=X', y.bb_upper, NULL)) as krwusd_x_bb_upper,
    MAX(IF(s.symbol='KRWUSD=X', y.momentum_10, NULL)) as krwusd_x_momentum,
    MAX(IF(s.symbol='KWEB', y.close, NULL)) as kweb_close,
    MAX(IF(s.symbol='KWEB', y.rsi_14, NULL)) as kweb_rsi_14,
    MAX(IF(s.symbol='KWEB', y.ma_30d, NULL)) as kweb_ma_30d,
    MAX(IF(s.symbol='KWEB', y.macd_line, NULL)) as kweb_macd,
    MAX(IF(s.symbol='KWEB', y.atr_14, NULL)) as kweb_atr,
    MAX(IF(s.symbol='KWEB', y.bb_upper, NULL)) as kweb_bb_upper,
    MAX(IF(s.symbol='KWEB', y.momentum_10, NULL)) as kweb_momentum,
    MAX(IF(s.symbol='LBS=F', y.close, NULL)) as lbs_f_close,
    MAX(IF(s.symbol='LBS=F', y.rsi_14, NULL)) as lbs_f_rsi_14,
    MAX(IF(s.symbol='LBS=F', y.ma_30d, NULL)) as lbs_f_ma_30d,
    MAX(IF(s.symbol='LBS=F', y.macd_line, NULL)) as lbs_f_macd,
    MAX(IF(s.symbol='LBS=F', y.atr_14, NULL)) as lbs_f_atr,
    MAX(IF(s.symbol='LBS=F', y.bb_upper, NULL)) as lbs_f_bb_upper,
    MAX(IF(s.symbol='LBS=F', y.momentum_10, NULL)) as lbs_f_momentum,
    MAX(IF(s.symbol='LE=F', y.close, NULL)) as le_f_close,
    MAX(IF(s.symbol='LE=F', y.rsi_14, NULL)) as le_f_rsi_14,
    MAX(IF(s.symbol='LE=F', y.ma_30d, NULL)) as le_f_ma_30d,
    MAX(IF(s.symbol='LE=F', y.macd_line, NULL)) as le_f_macd,
    MAX(IF(s.symbol='LE=F', y.atr_14, NULL)) as le_f_atr,
    MAX(IF(s.symbol='LE=F', y.bb_upper, NULL)) as le_f_bb_upper,
    MAX(IF(s.symbol='LE=F', y.momentum_10, NULL)) as le_f_momentum,
    MAX(IF(s.symbol='LQD', y.close, NULL)) as lqd_close,
    MAX(IF(s.symbol='LQD', y.rsi_14, NULL)) as lqd_rsi_14,
    MAX(IF(s.symbol='LQD', y.ma_30d, NULL)) as lqd_ma_30d,
    MAX(IF(s.symbol='LQD', y.macd_line, NULL)) as lqd_macd,
    MAX(IF(s.symbol='LQD', y.atr_14, NULL)) as lqd_atr,
    MAX(IF(s.symbol='LQD', y.bb_upper, NULL)) as lqd_bb_upper,
    MAX(IF(s.symbol='LQD', y.momentum_10, NULL)) as lqd_momentum,
    MAX(IF(s.symbol='LW', y.close, NULL)) as lw_close,
    MAX(IF(s.symbol='LW', y.rsi_14, NULL)) as lw_rsi_14,
    MAX(IF(s.symbol='LW', y.ma_30d, NULL)) as lw_ma_30d,
    MAX(IF(s.symbol='LW', y.macd_line, NULL)) as lw_macd,
    MAX(IF(s.symbol='LW', y.atr_14, NULL)) as lw_atr,
    MAX(IF(s.symbol='LW', y.bb_upper, NULL)) as lw_bb_upper,
    MAX(IF(s.symbol='LW', y.momentum_10, NULL)) as lw_momentum,
    MAX(IF(s.symbol='MCHI', y.close, NULL)) as mchi_close,
    MAX(IF(s.symbol='MCHI', y.rsi_14, NULL)) as mchi_rsi_14,
    MAX(IF(s.symbol='MCHI', y.ma_30d, NULL)) as mchi_ma_30d,
    MAX(IF(s.symbol='MCHI', y.macd_line, NULL)) as mchi_macd,
    MAX(IF(s.symbol='MCHI', y.atr_14, NULL)) as mchi_atr,
    MAX(IF(s.symbol='MCHI', y.bb_upper, NULL)) as mchi_bb_upper,
    MAX(IF(s.symbol='MCHI', y.momentum_10, NULL)) as mchi_momentum,
    MAX(IF(s.symbol='MCL=F', y.close, NULL)) as mcl_f_close,
    MAX(IF(s.symbol='MCL=F', y.rsi_14, NULL)) as mcl_f_rsi_14,
    MAX(IF(s.symbol='MCL=F', y.ma_30d, NULL)) as mcl_f_ma_30d,
    MAX(IF(s.symbol='MCL=F', y.macd_line, NULL)) as mcl_f_macd,
    MAX(IF(s.symbol='MCL=F', y.atr_14, NULL)) as mcl_f_atr,
    MAX(IF(s.symbol='MCL=F', y.bb_upper, NULL)) as mcl_f_bb_upper,
    MAX(IF(s.symbol='MCL=F', y.momentum_10, NULL)) as mcl_f_momentum,
    MAX(IF(s.symbol='MOS', y.close, NULL)) as mos_close_yh,
    MAX(IF(s.symbol='MOS', y.rsi_14, NULL)) as mos_rsi_14_yh,
    MAX(IF(s.symbol='MOS', y.ma_30d, NULL)) as mos_ma_30d_yh,
    MAX(IF(s.symbol='MOS', y.macd_line, NULL)) as mos_macd_yh,
    MAX(IF(s.symbol='MOS', y.atr_14, NULL)) as mos_atr_yh,
    MAX(IF(s.symbol='MOS', y.bb_upper, NULL)) as mos_bb_upper_yh,
    MAX(IF(s.symbol='MOS', y.momentum_10, NULL)) as mos_momentum_yh,
    MAX(IF(s.symbol='MPC', y.close, NULL)) as mpc_close,
    MAX(IF(s.symbol='MPC', y.rsi_14, NULL)) as mpc_rsi_14,
    MAX(IF(s.symbol='MPC', y.ma_30d, NULL)) as mpc_ma_30d,
    MAX(IF(s.symbol='MPC', y.macd_line, NULL)) as mpc_macd,
    MAX(IF(s.symbol='MPC', y.atr_14, NULL)) as mpc_atr,
    MAX(IF(s.symbol='MPC', y.bb_upper, NULL)) as mpc_bb_upper,
    MAX(IF(s.symbol='MPC', y.momentum_10, NULL)) as mpc_momentum,
    MAX(IF(s.symbol='MTF=F', y.close, NULL)) as mtf_f_close,
    MAX(IF(s.symbol='MTF=F', y.rsi_14, NULL)) as mtf_f_rsi_14,
    MAX(IF(s.symbol='MTF=F', y.ma_30d, NULL)) as mtf_f_ma_30d,
    MAX(IF(s.symbol='MTF=F', y.macd_line, NULL)) as mtf_f_macd,
    MAX(IF(s.symbol='MTF=F', y.atr_14, NULL)) as mtf_f_atr,
    MAX(IF(s.symbol='MTF=F', y.bb_upper, NULL)) as mtf_f_bb_upper,
    MAX(IF(s.symbol='MTF=F', y.momentum_10, NULL)) as mtf_f_momentum,
    MAX(IF(s.symbol='MXNUSD=X', y.close, NULL)) as mxnusd_x_close,
    MAX(IF(s.symbol='MXNUSD=X', y.rsi_14, NULL)) as mxnusd_x_rsi_14,
    MAX(IF(s.symbol='MXNUSD=X', y.ma_30d, NULL)) as mxnusd_x_ma_30d,
    MAX(IF(s.symbol='MXNUSD=X', y.macd_line, NULL)) as mxnusd_x_macd,
    MAX(IF(s.symbol='MXNUSD=X', y.atr_14, NULL)) as mxnusd_x_atr,
    MAX(IF(s.symbol='MXNUSD=X', y.bb_upper, NULL)) as mxnusd_x_bb_upper,
    MAX(IF(s.symbol='MXNUSD=X', y.momentum_10, NULL)) as mxnusd_x_momentum,
    MAX(IF(s.symbol='MYRUSD=X', y.close, NULL)) as myrusd_x_close,
    MAX(IF(s.symbol='MYRUSD=X', y.rsi_14, NULL)) as myrusd_x_rsi_14,
    MAX(IF(s.symbol='MYRUSD=X', y.ma_30d, NULL)) as myrusd_x_ma_30d,
    MAX(IF(s.symbol='MYRUSD=X', y.macd_line, NULL)) as myrusd_x_macd,
    MAX(IF(s.symbol='MYRUSD=X', y.atr_14, NULL)) as myrusd_x_atr,
    MAX(IF(s.symbol='MYRUSD=X', y.bb_upper, NULL)) as myrusd_x_bb_upper,
    MAX(IF(s.symbol='MYRUSD=X', y.momentum_10, NULL)) as myrusd_x_momentum,
    MAX(IF(s.symbol='NG=F', y.close, NULL)) as ng_f_close_yh,
    MAX(IF(s.symbol='NG=F', y.rsi_14, NULL)) as ng_f_rsi_14_yh,
    MAX(IF(s.symbol='NG=F', y.ma_30d, NULL)) as ng_f_ma_30d_yh,
    MAX(IF(s.symbol='NG=F', y.macd_line, NULL)) as ng_f_macd_yh,
    MAX(IF(s.symbol='NG=F', y.atr_14, NULL)) as ng_f_atr_yh,
    MAX(IF(s.symbol='NG=F', y.bb_upper, NULL)) as ng_f_bb_upper_yh,
    MAX(IF(s.symbol='NG=F', y.momentum_10, NULL)) as ng_f_momentum_yh,
    MAX(IF(s.symbol='NIB', y.close, NULL)) as nib_close,
    MAX(IF(s.symbol='NIB', y.rsi_14, NULL)) as nib_rsi_14,
    MAX(IF(s.symbol='NIB', y.ma_30d, NULL)) as nib_ma_30d,
    MAX(IF(s.symbol='NIB', y.macd_line, NULL)) as nib_macd,
    MAX(IF(s.symbol='NIB', y.atr_14, NULL)) as nib_atr,
    MAX(IF(s.symbol='NIB', y.bb_upper, NULL)) as nib_bb_upper,
    MAX(IF(s.symbol='NIB', y.momentum_10, NULL)) as nib_momentum,
    MAX(IF(s.symbol='NMM', y.close, NULL)) as nmm_close,
    MAX(IF(s.symbol='NMM', y.rsi_14, NULL)) as nmm_rsi_14,
    MAX(IF(s.symbol='NMM', y.ma_30d, NULL)) as nmm_ma_30d,
    MAX(IF(s.symbol='NMM', y.macd_line, NULL)) as nmm_macd,
    MAX(IF(s.symbol='NMM', y.atr_14, NULL)) as nmm_atr,
    MAX(IF(s.symbol='NMM', y.bb_upper, NULL)) as nmm_bb_upper,
    MAX(IF(s.symbol='NMM', y.momentum_10, NULL)) as nmm_momentum,
    MAX(IF(s.symbol='NTR', y.close, NULL)) as ntr_close_yh,
    MAX(IF(s.symbol='NTR', y.rsi_14, NULL)) as ntr_rsi_14_yh,
    MAX(IF(s.symbol='NTR', y.ma_30d, NULL)) as ntr_ma_30d_yh,
    MAX(IF(s.symbol='NTR', y.macd_line, NULL)) as ntr_macd_yh,
    MAX(IF(s.symbol='NTR', y.atr_14, NULL)) as ntr_atr_yh,
    MAX(IF(s.symbol='NTR', y.bb_upper, NULL)) as ntr_bb_upper_yh,
    MAX(IF(s.symbol='NTR', y.momentum_10, NULL)) as ntr_momentum_yh,
    MAX(IF(s.symbol='OJ=F', y.close, NULL)) as oj_f_close,
    MAX(IF(s.symbol='OJ=F', y.rsi_14, NULL)) as oj_f_rsi_14,
    MAX(IF(s.symbol='OJ=F', y.ma_30d, NULL)) as oj_f_ma_30d,
    MAX(IF(s.symbol='OJ=F', y.macd_line, NULL)) as oj_f_macd,
    MAX(IF(s.symbol='OJ=F', y.atr_14, NULL)) as oj_f_atr,
    MAX(IF(s.symbol='OJ=F', y.bb_upper, NULL)) as oj_f_bb_upper,
    MAX(IF(s.symbol='OJ=F', y.momentum_10, NULL)) as oj_f_momentum,
    MAX(IF(s.symbol='OXY', y.close, NULL)) as oxy_close,
    MAX(IF(s.symbol='OXY', y.rsi_14, NULL)) as oxy_rsi_14,
    MAX(IF(s.symbol='OXY', y.ma_30d, NULL)) as oxy_ma_30d,
    MAX(IF(s.symbol='OXY', y.macd_line, NULL)) as oxy_macd,
    MAX(IF(s.symbol='OXY', y.atr_14, NULL)) as oxy_atr,
    MAX(IF(s.symbol='OXY', y.bb_upper, NULL)) as oxy_bb_upper,
    MAX(IF(s.symbol='OXY', y.momentum_10, NULL)) as oxy_momentum,
    MAX(IF(s.symbol='PA=F', y.close, NULL)) as pa_f_close,
    MAX(IF(s.symbol='PA=F', y.rsi_14, NULL)) as pa_f_rsi_14,
    MAX(IF(s.symbol='PA=F', y.ma_30d, NULL)) as pa_f_ma_30d,
    MAX(IF(s.symbol='PA=F', y.macd_line, NULL)) as pa_f_macd,
    MAX(IF(s.symbol='PA=F', y.atr_14, NULL)) as pa_f_atr,
    MAX(IF(s.symbol='PA=F', y.bb_upper, NULL)) as pa_f_bb_upper,
    MAX(IF(s.symbol='PA=F', y.momentum_10, NULL)) as pa_f_momentum,
    MAX(IF(s.symbol='PALL', y.close, NULL)) as pall_close,
    MAX(IF(s.symbol='PALL', y.rsi_14, NULL)) as pall_rsi_14,
    MAX(IF(s.symbol='PALL', y.ma_30d, NULL)) as pall_ma_30d,
    MAX(IF(s.symbol='PALL', y.macd_line, NULL)) as pall_macd,
    MAX(IF(s.symbol='PALL', y.atr_14, NULL)) as pall_atr,
    MAX(IF(s.symbol='PALL', y.bb_upper, NULL)) as pall_bb_upper,
    MAX(IF(s.symbol='PALL', y.momentum_10, NULL)) as pall_momentum,
    MAX(IF(s.symbol='PAVE', y.close, NULL)) as pave_close,
    MAX(IF(s.symbol='PAVE', y.rsi_14, NULL)) as pave_rsi_14,
    MAX(IF(s.symbol='PAVE', y.ma_30d, NULL)) as pave_ma_30d,
    MAX(IF(s.symbol='PAVE', y.macd_line, NULL)) as pave_macd,
    MAX(IF(s.symbol='PAVE', y.atr_14, NULL)) as pave_atr,
    MAX(IF(s.symbol='PAVE', y.bb_upper, NULL)) as pave_bb_upper,
    MAX(IF(s.symbol='PAVE', y.momentum_10, NULL)) as pave_momentum,
    MAX(IF(s.symbol='PCY', y.close, NULL)) as pcy_close,
    MAX(IF(s.symbol='PCY', y.rsi_14, NULL)) as pcy_rsi_14,
    MAX(IF(s.symbol='PCY', y.ma_30d, NULL)) as pcy_ma_30d,
    MAX(IF(s.symbol='PCY', y.macd_line, NULL)) as pcy_macd,
    MAX(IF(s.symbol='PCY', y.atr_14, NULL)) as pcy_atr,
    MAX(IF(s.symbol='PCY', y.bb_upper, NULL)) as pcy_bb_upper,
    MAX(IF(s.symbol='PCY', y.momentum_10, NULL)) as pcy_momentum,
    MAX(IF(s.symbol='PHPUSD=X', y.close, NULL)) as phpusd_x_close,
    MAX(IF(s.symbol='PHPUSD=X', y.rsi_14, NULL)) as phpusd_x_rsi_14,
    MAX(IF(s.symbol='PHPUSD=X', y.ma_30d, NULL)) as phpusd_x_ma_30d,
    MAX(IF(s.symbol='PHPUSD=X', y.macd_line, NULL)) as phpusd_x_macd,
    MAX(IF(s.symbol='PHPUSD=X', y.atr_14, NULL)) as phpusd_x_atr,
    MAX(IF(s.symbol='PHPUSD=X', y.bb_upper, NULL)) as phpusd_x_bb_upper,
    MAX(IF(s.symbol='PHPUSD=X', y.momentum_10, NULL)) as phpusd_x_momentum,
    MAX(IF(s.symbol='PL=F', y.close, NULL)) as pl_f_close,
    MAX(IF(s.symbol='PL=F', y.rsi_14, NULL)) as pl_f_rsi_14,
    MAX(IF(s.symbol='PL=F', y.ma_30d, NULL)) as pl_f_ma_30d,
    MAX(IF(s.symbol='PL=F', y.macd_line, NULL)) as pl_f_macd,
    MAX(IF(s.symbol='PL=F', y.atr_14, NULL)) as pl_f_atr,
    MAX(IF(s.symbol='PL=F', y.bb_upper, NULL)) as pl_f_bb_upper,
    MAX(IF(s.symbol='PL=F', y.momentum_10, NULL)) as pl_f_momentum,
    MAX(IF(s.symbol='PLUG', y.close, NULL)) as plug_close,
    MAX(IF(s.symbol='PLUG', y.rsi_14, NULL)) as plug_rsi_14,
    MAX(IF(s.symbol='PLUG', y.ma_30d, NULL)) as plug_ma_30d,
    MAX(IF(s.symbol='PLUG', y.macd_line, NULL)) as plug_macd,
    MAX(IF(s.symbol='PLUG', y.atr_14, NULL)) as plug_atr,
    MAX(IF(s.symbol='PLUG', y.bb_upper, NULL)) as plug_bb_upper,
    MAX(IF(s.symbol='PLUG', y.momentum_10, NULL)) as plug_momentum,
    MAX(IF(s.symbol='PN0=F', y.close, NULL)) as pn0_f_close,
    MAX(IF(s.symbol='PN0=F', y.rsi_14, NULL)) as pn0_f_rsi_14,
    MAX(IF(s.symbol='PN0=F', y.ma_30d, NULL)) as pn0_f_ma_30d,
    MAX(IF(s.symbol='PN0=F', y.macd_line, NULL)) as pn0_f_macd,
    MAX(IF(s.symbol='PN0=F', y.atr_14, NULL)) as pn0_f_atr,
    MAX(IF(s.symbol='PN0=F', y.bb_upper, NULL)) as pn0_f_bb_upper,
    MAX(IF(s.symbol='PN0=F', y.momentum_10, NULL)) as pn0_f_momentum,
    MAX(IF(s.symbol='PPLT', y.close, NULL)) as pplt_close,
    MAX(IF(s.symbol='PPLT', y.rsi_14, NULL)) as pplt_rsi_14,
    MAX(IF(s.symbol='PPLT', y.ma_30d, NULL)) as pplt_ma_30d,
    MAX(IF(s.symbol='PPLT', y.macd_line, NULL)) as pplt_macd,
    MAX(IF(s.symbol='PPLT', y.atr_14, NULL)) as pplt_atr,
    MAX(IF(s.symbol='PPLT', y.bb_upper, NULL)) as pplt_bb_upper,
    MAX(IF(s.symbol='PPLT', y.momentum_10, NULL)) as pplt_momentum,
    MAX(IF(s.symbol='PSX', y.close, NULL)) as psx_close,
    MAX(IF(s.symbol='PSX', y.rsi_14, NULL)) as psx_rsi_14,
    MAX(IF(s.symbol='PSX', y.ma_30d, NULL)) as psx_ma_30d,
    MAX(IF(s.symbol='PSX', y.macd_line, NULL)) as psx_macd,
    MAX(IF(s.symbol='PSX', y.atr_14, NULL)) as psx_atr,
    MAX(IF(s.symbol='PSX', y.bb_upper, NULL)) as psx_bb_upper,
    MAX(IF(s.symbol='PSX', y.momentum_10, NULL)) as psx_momentum,
    MAX(IF(s.symbol='QM=F', y.close, NULL)) as qm_f_close,
    MAX(IF(s.symbol='QM=F', y.rsi_14, NULL)) as qm_f_rsi_14,
    MAX(IF(s.symbol='QM=F', y.ma_30d, NULL)) as qm_f_ma_30d,
    MAX(IF(s.symbol='QM=F', y.macd_line, NULL)) as qm_f_macd,
    MAX(IF(s.symbol='QM=F', y.atr_14, NULL)) as qm_f_atr,
    MAX(IF(s.symbol='QM=F', y.bb_upper, NULL)) as qm_f_bb_upper,
    MAX(IF(s.symbol='QM=F', y.momentum_10, NULL)) as qm_f_momentum,
    MAX(IF(s.symbol='RB=F', y.close, NULL)) as rb_f_close_yh,
    MAX(IF(s.symbol='RB=F', y.rsi_14, NULL)) as rb_f_rsi_14_yh,
    MAX(IF(s.symbol='RB=F', y.ma_30d, NULL)) as rb_f_ma_30d_yh,
    MAX(IF(s.symbol='RB=F', y.macd_line, NULL)) as rb_f_macd_yh,
    MAX(IF(s.symbol='RB=F', y.atr_14, NULL)) as rb_f_atr_yh,
    MAX(IF(s.symbol='RB=F', y.bb_upper, NULL)) as rb_f_bb_upper_yh,
    MAX(IF(s.symbol='RB=F', y.momentum_10, NULL)) as rb_f_momentum_yh,
    MAX(IF(s.symbol='RS=F', y.close, NULL)) as rs_f_close,
    MAX(IF(s.symbol='RS=F', y.rsi_14, NULL)) as rs_f_rsi_14,
    MAX(IF(s.symbol='RS=F', y.ma_30d, NULL)) as rs_f_ma_30d,
    MAX(IF(s.symbol='RS=F', y.macd_line, NULL)) as rs_f_macd,
    MAX(IF(s.symbol='RS=F', y.atr_14, NULL)) as rs_f_atr,
    MAX(IF(s.symbol='RS=F', y.bb_upper, NULL)) as rs_f_bb_upper,
    MAX(IF(s.symbol='RS=F', y.momentum_10, NULL)) as rs_f_momentum,
    MAX(IF(s.symbol='RSG', y.close, NULL)) as rsg_close,
    MAX(IF(s.symbol='RSG', y.rsi_14, NULL)) as rsg_rsi_14,
    MAX(IF(s.symbol='RSG', y.ma_30d, NULL)) as rsg_ma_30d,
    MAX(IF(s.symbol='RSG', y.macd_line, NULL)) as rsg_macd,
    MAX(IF(s.symbol='RSG', y.atr_14, NULL)) as rsg_atr,
    MAX(IF(s.symbol='RSG', y.bb_upper, NULL)) as rsg_bb_upper,
    MAX(IF(s.symbol='RSG', y.momentum_10, NULL)) as rsg_momentum,
    MAX(IF(s.symbol='RUBUSD=X', y.close, NULL)) as rubusd_x_close,
    MAX(IF(s.symbol='RUBUSD=X', y.rsi_14, NULL)) as rubusd_x_rsi_14,
    MAX(IF(s.symbol='RUBUSD=X', y.ma_30d, NULL)) as rubusd_x_ma_30d,
    MAX(IF(s.symbol='RUBUSD=X', y.macd_line, NULL)) as rubusd_x_macd,
    MAX(IF(s.symbol='RUBUSD=X', y.atr_14, NULL)) as rubusd_x_atr,
    MAX(IF(s.symbol='RUBUSD=X', y.bb_upper, NULL)) as rubusd_x_bb_upper,
    MAX(IF(s.symbol='RUBUSD=X', y.momentum_10, NULL)) as rubusd_x_momentum,
    MAX(IF(s.symbol='SB', y.close, NULL)) as sb_close,
    MAX(IF(s.symbol='SB', y.rsi_14, NULL)) as sb_rsi_14,
    MAX(IF(s.symbol='SB', y.ma_30d, NULL)) as sb_ma_30d,
    MAX(IF(s.symbol='SB', y.macd_line, NULL)) as sb_macd,
    MAX(IF(s.symbol='SB', y.atr_14, NULL)) as sb_atr,
    MAX(IF(s.symbol='SB', y.bb_upper, NULL)) as sb_bb_upper,
    MAX(IF(s.symbol='SB', y.momentum_10, NULL)) as sb_momentum,
    MAX(IF(s.symbol='SB=F', y.close, NULL)) as sb_f_close,
    MAX(IF(s.symbol='SB=F', y.rsi_14, NULL)) as sb_f_rsi_14,
    MAX(IF(s.symbol='SB=F', y.ma_30d, NULL)) as sb_f_ma_30d,
    MAX(IF(s.symbol='SB=F', y.macd_line, NULL)) as sb_f_macd,
    MAX(IF(s.symbol='SB=F', y.atr_14, NULL)) as sb_f_atr,
    MAX(IF(s.symbol='SB=F', y.bb_upper, NULL)) as sb_f_bb_upper,
    MAX(IF(s.symbol='SB=F', y.momentum_10, NULL)) as sb_f_momentum,
    MAX(IF(s.symbol='SBLK', y.close, NULL)) as sblk_close,
    MAX(IF(s.symbol='SBLK', y.rsi_14, NULL)) as sblk_rsi_14,
    MAX(IF(s.symbol='SBLK', y.ma_30d, NULL)) as sblk_ma_30d,
    MAX(IF(s.symbol='SBLK', y.macd_line, NULL)) as sblk_macd,
    MAX(IF(s.symbol='SBLK', y.atr_14, NULL)) as sblk_atr,
    MAX(IF(s.symbol='SBLK', y.bb_upper, NULL)) as sblk_bb_upper,
    MAX(IF(s.symbol='SBLK', y.momentum_10, NULL)) as sblk_momentum,
    MAX(IF(s.symbol='SBS', y.close, NULL)) as sbs_close,
    MAX(IF(s.symbol='SBS', y.rsi_14, NULL)) as sbs_rsi_14,
    MAX(IF(s.symbol='SBS', y.ma_30d, NULL)) as sbs_ma_30d,
    MAX(IF(s.symbol='SBS', y.macd_line, NULL)) as sbs_macd,
    MAX(IF(s.symbol='SBS', y.atr_14, NULL)) as sbs_atr,
    MAX(IF(s.symbol='SBS', y.bb_upper, NULL)) as sbs_bb_upper,
    MAX(IF(s.symbol='SBS', y.momentum_10, NULL)) as sbs_momentum,
    MAX(IF(s.symbol='SEB', y.close, NULL)) as seb_close,
    MAX(IF(s.symbol='SEB', y.rsi_14, NULL)) as seb_rsi_14,
    MAX(IF(s.symbol='SEB', y.ma_30d, NULL)) as seb_ma_30d,
    MAX(IF(s.symbol='SEB', y.macd_line, NULL)) as seb_macd,
    MAX(IF(s.symbol='SEB', y.atr_14, NULL)) as seb_atr,
    MAX(IF(s.symbol='SEB', y.bb_upper, NULL)) as seb_bb_upper,
    MAX(IF(s.symbol='SEB', y.momentum_10, NULL)) as seb_momentum,
    MAX(IF(s.symbol='SEDG', y.close, NULL)) as sedg_close,
    MAX(IF(s.symbol='SEDG', y.rsi_14, NULL)) as sedg_rsi_14,
    MAX(IF(s.symbol='SEDG', y.ma_30d, NULL)) as sedg_ma_30d,
    MAX(IF(s.symbol='SEDG', y.macd_line, NULL)) as sedg_macd,
    MAX(IF(s.symbol='SEDG', y.atr_14, NULL)) as sedg_atr,
    MAX(IF(s.symbol='SEDG', y.bb_upper, NULL)) as sedg_bb_upper,
    MAX(IF(s.symbol='SEDG', y.momentum_10, NULL)) as sedg_momentum,
    MAX(IF(s.symbol='SGDUSD=X', y.close, NULL)) as sgdusd_x_close,
    MAX(IF(s.symbol='SGDUSD=X', y.rsi_14, NULL)) as sgdusd_x_rsi_14,
    MAX(IF(s.symbol='SGDUSD=X', y.ma_30d, NULL)) as sgdusd_x_ma_30d,
    MAX(IF(s.symbol='SGDUSD=X', y.macd_line, NULL)) as sgdusd_x_macd,
    MAX(IF(s.symbol='SGDUSD=X', y.atr_14, NULL)) as sgdusd_x_atr,
    MAX(IF(s.symbol='SGDUSD=X', y.bb_upper, NULL)) as sgdusd_x_bb_upper,
    MAX(IF(s.symbol='SGDUSD=X', y.momentum_10, NULL)) as sgdusd_x_momentum,
    MAX(IF(s.symbol='SGG', y.close, NULL)) as sgg_close,
    MAX(IF(s.symbol='SGG', y.rsi_14, NULL)) as sgg_rsi_14,
    MAX(IF(s.symbol='SGG', y.ma_30d, NULL)) as sgg_ma_30d,
    MAX(IF(s.symbol='SGG', y.macd_line, NULL)) as sgg_macd,
    MAX(IF(s.symbol='SGG', y.atr_14, NULL)) as sgg_atr,
    MAX(IF(s.symbol='SGG', y.bb_upper, NULL)) as sgg_bb_upper,
    MAX(IF(s.symbol='SGG', y.momentum_10, NULL)) as sgg_momentum,
    MAX(IF(s.symbol='SHIP', y.close, NULL)) as ship_close,
    MAX(IF(s.symbol='SHIP', y.rsi_14, NULL)) as ship_rsi_14,
    MAX(IF(s.symbol='SHIP', y.ma_30d, NULL)) as ship_ma_30d,
    MAX(IF(s.symbol='SHIP', y.macd_line, NULL)) as ship_macd,
    MAX(IF(s.symbol='SHIP', y.atr_14, NULL)) as ship_atr,
    MAX(IF(s.symbol='SHIP', y.bb_upper, NULL)) as ship_bb_upper,
    MAX(IF(s.symbol='SHIP', y.momentum_10, NULL)) as ship_momentum,
    MAX(IF(s.symbol='SHY', y.close, NULL)) as shy_close,
    MAX(IF(s.symbol='SHY', y.rsi_14, NULL)) as shy_rsi_14,
    MAX(IF(s.symbol='SHY', y.ma_30d, NULL)) as shy_ma_30d,
    MAX(IF(s.symbol='SHY', y.macd_line, NULL)) as shy_macd,
    MAX(IF(s.symbol='SHY', y.atr_14, NULL)) as shy_atr,
    MAX(IF(s.symbol='SHY', y.bb_upper, NULL)) as shy_bb_upper,
    MAX(IF(s.symbol='SHY', y.momentum_10, NULL)) as shy_momentum,
    MAX(IF(s.symbol='SI=F', y.close, NULL)) as si_f_close,
    MAX(IF(s.symbol='SI=F', y.rsi_14, NULL)) as si_f_rsi_14,
    MAX(IF(s.symbol='SI=F', y.ma_30d, NULL)) as si_f_ma_30d,
    MAX(IF(s.symbol='SI=F', y.macd_line, NULL)) as si_f_macd,
    MAX(IF(s.symbol='SI=F', y.atr_14, NULL)) as si_f_atr,
    MAX(IF(s.symbol='SI=F', y.bb_upper, NULL)) as si_f_bb_upper,
    MAX(IF(s.symbol='SI=F', y.momentum_10, NULL)) as si_f_momentum,
    MAX(IF(s.symbol='SLB', y.close, NULL)) as slb_close,
    MAX(IF(s.symbol='SLB', y.rsi_14, NULL)) as slb_rsi_14,
    MAX(IF(s.symbol='SLB', y.ma_30d, NULL)) as slb_ma_30d,
    MAX(IF(s.symbol='SLB', y.macd_line, NULL)) as slb_macd,
    MAX(IF(s.symbol='SLB', y.atr_14, NULL)) as slb_atr,
    MAX(IF(s.symbol='SLB', y.bb_upper, NULL)) as slb_bb_upper,
    MAX(IF(s.symbol='SLB', y.momentum_10, NULL)) as slb_momentum,
    MAX(IF(s.symbol='SLV', y.close, NULL)) as slv_close,
    MAX(IF(s.symbol='SLV', y.rsi_14, NULL)) as slv_rsi_14,
    MAX(IF(s.symbol='SLV', y.ma_30d, NULL)) as slv_ma_30d,
    MAX(IF(s.symbol='SLV', y.macd_line, NULL)) as slv_macd,
    MAX(IF(s.symbol='SLV', y.atr_14, NULL)) as slv_atr,
    MAX(IF(s.symbol='SLV', y.bb_upper, NULL)) as slv_bb_upper,
    MAX(IF(s.symbol='SLV', y.momentum_10, NULL)) as slv_momentum,
    MAX(IF(s.symbol='SMG', y.close, NULL)) as smg_close,
    MAX(IF(s.symbol='SMG', y.rsi_14, NULL)) as smg_rsi_14,
    MAX(IF(s.symbol='SMG', y.ma_30d, NULL)) as smg_ma_30d,
    MAX(IF(s.symbol='SMG', y.macd_line, NULL)) as smg_macd,
    MAX(IF(s.symbol='SMG', y.atr_14, NULL)) as smg_atr,
    MAX(IF(s.symbol='SMG', y.bb_upper, NULL)) as smg_bb_upper,
    MAX(IF(s.symbol='SMG', y.momentum_10, NULL)) as smg_momentum,
    MAX(IF(s.symbol='SOYB', y.close, NULL)) as soyb_close_yh,
    MAX(IF(s.symbol='SOYB', y.rsi_14, NULL)) as soyb_rsi_14_yh,
    MAX(IF(s.symbol='SOYB', y.ma_30d, NULL)) as soyb_ma_30d_yh,
    MAX(IF(s.symbol='SOYB', y.macd_line, NULL)) as soyb_macd_yh,
    MAX(IF(s.symbol='SOYB', y.atr_14, NULL)) as soyb_atr_yh,
    MAX(IF(s.symbol='SOYB', y.bb_upper, NULL)) as soyb_bb_upper_yh,
    MAX(IF(s.symbol='SOYB', y.momentum_10, NULL)) as soyb_momentum_yh,
    MAX(IF(s.symbol='SVXY', y.close, NULL)) as svxy_close,
    MAX(IF(s.symbol='SVXY', y.rsi_14, NULL)) as svxy_rsi_14,
    MAX(IF(s.symbol='SVXY', y.ma_30d, NULL)) as svxy_ma_30d,
    MAX(IF(s.symbol='SVXY', y.macd_line, NULL)) as svxy_macd,
    MAX(IF(s.symbol='SVXY', y.atr_14, NULL)) as svxy_atr,
    MAX(IF(s.symbol='SVXY', y.bb_upper, NULL)) as svxy_bb_upper,
    MAX(IF(s.symbol='SVXY', y.momentum_10, NULL)) as svxy_momentum,
    MAX(IF(s.symbol='TAN', y.close, NULL)) as tan_close,
    MAX(IF(s.symbol='TAN', y.rsi_14, NULL)) as tan_rsi_14,
    MAX(IF(s.symbol='TAN', y.ma_30d, NULL)) as tan_ma_30d,
    MAX(IF(s.symbol='TAN', y.macd_line, NULL)) as tan_macd,
    MAX(IF(s.symbol='TAN', y.atr_14, NULL)) as tan_atr,
    MAX(IF(s.symbol='TAN', y.bb_upper, NULL)) as tan_bb_upper,
    MAX(IF(s.symbol='TAN', y.momentum_10, NULL)) as tan_momentum,
    MAX(IF(s.symbol='THBUSD=X', y.close, NULL)) as thbusd_x_close,
    MAX(IF(s.symbol='THBUSD=X', y.rsi_14, NULL)) as thbusd_x_rsi_14,
    MAX(IF(s.symbol='THBUSD=X', y.ma_30d, NULL)) as thbusd_x_ma_30d,
    MAX(IF(s.symbol='THBUSD=X', y.macd_line, NULL)) as thbusd_x_macd,
    MAX(IF(s.symbol='THBUSD=X', y.atr_14, NULL)) as thbusd_x_atr,
    MAX(IF(s.symbol='THBUSD=X', y.bb_upper, NULL)) as thbusd_x_bb_upper,
    MAX(IF(s.symbol='THBUSD=X', y.momentum_10, NULL)) as thbusd_x_momentum,
    MAX(IF(s.symbol='TIP', y.close, NULL)) as tip_close,
    MAX(IF(s.symbol='TIP', y.rsi_14, NULL)) as tip_rsi_14,
    MAX(IF(s.symbol='TIP', y.ma_30d, NULL)) as tip_ma_30d,
    MAX(IF(s.symbol='TIP', y.macd_line, NULL)) as tip_macd,
    MAX(IF(s.symbol='TIP', y.atr_14, NULL)) as tip_atr,
    MAX(IF(s.symbol='TIP', y.bb_upper, NULL)) as tip_bb_upper,
    MAX(IF(s.symbol='TIP', y.momentum_10, NULL)) as tip_momentum,
    MAX(IF(s.symbol='TLT', y.close, NULL)) as tlt_close,
    MAX(IF(s.symbol='TLT', y.rsi_14, NULL)) as tlt_rsi_14,
    MAX(IF(s.symbol='TLT', y.ma_30d, NULL)) as tlt_ma_30d,
    MAX(IF(s.symbol='TLT', y.macd_line, NULL)) as tlt_macd,
    MAX(IF(s.symbol='TLT', y.atr_14, NULL)) as tlt_atr,
    MAX(IF(s.symbol='TLT', y.bb_upper, NULL)) as tlt_bb_upper,
    MAX(IF(s.symbol='TLT', y.momentum_10, NULL)) as tlt_momentum,
    MAX(IF(s.symbol='TOPS', y.close, NULL)) as tops_close,
    MAX(IF(s.symbol='TOPS', y.rsi_14, NULL)) as tops_rsi_14,
    MAX(IF(s.symbol='TOPS', y.ma_30d, NULL)) as tops_ma_30d,
    MAX(IF(s.symbol='TOPS', y.macd_line, NULL)) as tops_macd,
    MAX(IF(s.symbol='TOPS', y.atr_14, NULL)) as tops_atr,
    MAX(IF(s.symbol='TOPS', y.bb_upper, NULL)) as tops_bb_upper,
    MAX(IF(s.symbol='TOPS', y.momentum_10, NULL)) as tops_momentum,
    MAX(IF(s.symbol='TRYUSD=X', y.close, NULL)) as tryusd_x_close,
    MAX(IF(s.symbol='TRYUSD=X', y.rsi_14, NULL)) as tryusd_x_rsi_14,
    MAX(IF(s.symbol='TRYUSD=X', y.ma_30d, NULL)) as tryusd_x_ma_30d,
    MAX(IF(s.symbol='TRYUSD=X', y.macd_line, NULL)) as tryusd_x_macd,
    MAX(IF(s.symbol='TRYUSD=X', y.atr_14, NULL)) as tryusd_x_atr,
    MAX(IF(s.symbol='TRYUSD=X', y.bb_upper, NULL)) as tryusd_x_bb_upper,
    MAX(IF(s.symbol='TRYUSD=X', y.momentum_10, NULL)) as tryusd_x_momentum,
    MAX(IF(s.symbol='TSN', y.close, NULL)) as tsn_close_yh,
    MAX(IF(s.symbol='TSN', y.rsi_14, NULL)) as tsn_rsi_14_yh,
    MAX(IF(s.symbol='TSN', y.ma_30d, NULL)) as tsn_ma_30d_yh,
    MAX(IF(s.symbol='TSN', y.macd_line, NULL)) as tsn_macd_yh,
    MAX(IF(s.symbol='TSN', y.atr_14, NULL)) as tsn_atr_yh,
    MAX(IF(s.symbol='TSN', y.bb_upper, NULL)) as tsn_bb_upper_yh,
    MAX(IF(s.symbol='TSN', y.momentum_10, NULL)) as tsn_momentum_yh,
    MAX(IF(s.symbol='TWI', y.close, NULL)) as twi_close,
    MAX(IF(s.symbol='TWI', y.rsi_14, NULL)) as twi_rsi_14,
    MAX(IF(s.symbol='TWI', y.ma_30d, NULL)) as twi_ma_30d,
    MAX(IF(s.symbol='TWI', y.macd_line, NULL)) as twi_macd,
    MAX(IF(s.symbol='TWI', y.atr_14, NULL)) as twi_atr,
    MAX(IF(s.symbol='TWI', y.bb_upper, NULL)) as twi_bb_upper,
    MAX(IF(s.symbol='TWI', y.momentum_10, NULL)) as twi_momentum,
    MAX(IF(s.symbol='UDN', y.close, NULL)) as udn_close,
    MAX(IF(s.symbol='UDN', y.rsi_14, NULL)) as udn_rsi_14,
    MAX(IF(s.symbol='UDN', y.ma_30d, NULL)) as udn_ma_30d,
    MAX(IF(s.symbol='UDN', y.macd_line, NULL)) as udn_macd,
    MAX(IF(s.symbol='UDN', y.atr_14, NULL)) as udn_atr,
    MAX(IF(s.symbol='UDN', y.bb_upper, NULL)) as udn_bb_upper,
    MAX(IF(s.symbol='UDN', y.momentum_10, NULL)) as udn_momentum,
    MAX(IF(s.symbol='UNG', y.close, NULL)) as ung_close,
    MAX(IF(s.symbol='UNG', y.rsi_14, NULL)) as ung_rsi_14,
    MAX(IF(s.symbol='UNG', y.ma_30d, NULL)) as ung_ma_30d,
    MAX(IF(s.symbol='UNG', y.macd_line, NULL)) as ung_macd,
    MAX(IF(s.symbol='UNG', y.atr_14, NULL)) as ung_atr,
    MAX(IF(s.symbol='UNG', y.bb_upper, NULL)) as ung_bb_upper,
    MAX(IF(s.symbol='UNG', y.momentum_10, NULL)) as ung_momentum,
    MAX(IF(s.symbol='URA', y.close, NULL)) as ura_close,
    MAX(IF(s.symbol='URA', y.rsi_14, NULL)) as ura_rsi_14,
    MAX(IF(s.symbol='URA', y.ma_30d, NULL)) as ura_ma_30d,
    MAX(IF(s.symbol='URA', y.macd_line, NULL)) as ura_macd,
    MAX(IF(s.symbol='URA', y.atr_14, NULL)) as ura_atr,
    MAX(IF(s.symbol='URA', y.bb_upper, NULL)) as ura_bb_upper,
    MAX(IF(s.symbol='URA', y.momentum_10, NULL)) as ura_momentum,
    MAX(IF(s.symbol='USDD', y.close, NULL)) as usdd_close,
    MAX(IF(s.symbol='USDD', y.rsi_14, NULL)) as usdd_rsi_14,
    MAX(IF(s.symbol='USDD', y.ma_30d, NULL)) as usdd_ma_30d,
    MAX(IF(s.symbol='USDD', y.macd_line, NULL)) as usdd_macd,
    MAX(IF(s.symbol='USDD', y.atr_14, NULL)) as usdd_atr,
    MAX(IF(s.symbol='USDD', y.bb_upper, NULL)) as usdd_bb_upper,
    MAX(IF(s.symbol='USDD', y.momentum_10, NULL)) as usdd_momentum,
    MAX(IF(s.symbol='USDU', y.close, NULL)) as usdu_close,
    MAX(IF(s.symbol='USDU', y.rsi_14, NULL)) as usdu_rsi_14,
    MAX(IF(s.symbol='USDU', y.ma_30d, NULL)) as usdu_ma_30d,
    MAX(IF(s.symbol='USDU', y.macd_line, NULL)) as usdu_macd,
    MAX(IF(s.symbol='USDU', y.atr_14, NULL)) as usdu_atr,
    MAX(IF(s.symbol='USDU', y.bb_upper, NULL)) as usdu_bb_upper,
    MAX(IF(s.symbol='USDU', y.momentum_10, NULL)) as usdu_momentum,
    MAX(IF(s.symbol='USO', y.close, NULL)) as uso_close,
    MAX(IF(s.symbol='USO', y.rsi_14, NULL)) as uso_rsi_14,
    MAX(IF(s.symbol='USO', y.ma_30d, NULL)) as uso_ma_30d,
    MAX(IF(s.symbol='USO', y.macd_line, NULL)) as uso_macd,
    MAX(IF(s.symbol='USO', y.atr_14, NULL)) as uso_atr,
    MAX(IF(s.symbol='USO', y.bb_upper, NULL)) as uso_bb_upper,
    MAX(IF(s.symbol='USO', y.momentum_10, NULL)) as uso_momentum,
    MAX(IF(s.symbol='UUP', y.close, NULL)) as uup_close,
    MAX(IF(s.symbol='UUP', y.rsi_14, NULL)) as uup_rsi_14,
    MAX(IF(s.symbol='UUP', y.ma_30d, NULL)) as uup_ma_30d,
    MAX(IF(s.symbol='UUP', y.macd_line, NULL)) as uup_macd,
    MAX(IF(s.symbol='UUP', y.atr_14, NULL)) as uup_atr,
    MAX(IF(s.symbol='UUP', y.bb_upper, NULL)) as uup_bb_upper,
    MAX(IF(s.symbol='UUP', y.momentum_10, NULL)) as uup_momentum,
    MAX(IF(s.symbol='UVXY', y.close, NULL)) as uvxy_close,
    MAX(IF(s.symbol='UVXY', y.rsi_14, NULL)) as uvxy_rsi_14,
    MAX(IF(s.symbol='UVXY', y.ma_30d, NULL)) as uvxy_ma_30d,
    MAX(IF(s.symbol='UVXY', y.macd_line, NULL)) as uvxy_macd,
    MAX(IF(s.symbol='UVXY', y.atr_14, NULL)) as uvxy_atr,
    MAX(IF(s.symbol='UVXY', y.bb_upper, NULL)) as uvxy_bb_upper,
    MAX(IF(s.symbol='UVXY', y.momentum_10, NULL)) as uvxy_momentum,
    MAX(IF(s.symbol='VEGI', y.close, NULL)) as vegi_close,
    MAX(IF(s.symbol='VEGI', y.rsi_14, NULL)) as vegi_rsi_14,
    MAX(IF(s.symbol='VEGI', y.ma_30d, NULL)) as vegi_ma_30d,
    MAX(IF(s.symbol='VEGI', y.macd_line, NULL)) as vegi_macd,
    MAX(IF(s.symbol='VEGI', y.atr_14, NULL)) as vegi_atr,
    MAX(IF(s.symbol='VEGI', y.bb_upper, NULL)) as vegi_bb_upper,
    MAX(IF(s.symbol='VEGI', y.momentum_10, NULL)) as vegi_momentum,
    MAX(IF(s.symbol='VIX3M', y.close, NULL)) as vix3m_close,
    MAX(IF(s.symbol='VIX3M', y.rsi_14, NULL)) as vix3m_rsi_14,
    MAX(IF(s.symbol='VIX3M', y.ma_30d, NULL)) as vix3m_ma_30d,
    MAX(IF(s.symbol='VIX3M', y.macd_line, NULL)) as vix3m_macd,
    MAX(IF(s.symbol='VIX3M', y.atr_14, NULL)) as vix3m_atr,
    MAX(IF(s.symbol='VIX3M', y.bb_upper, NULL)) as vix3m_bb_upper,
    MAX(IF(s.symbol='VIX3M', y.momentum_10, NULL)) as vix3m_momentum,
    MAX(IF(s.symbol='VIX6M', y.close, NULL)) as vix6m_close,
    MAX(IF(s.symbol='VIX6M', y.rsi_14, NULL)) as vix6m_rsi_14,
    MAX(IF(s.symbol='VIX6M', y.ma_30d, NULL)) as vix6m_ma_30d,
    MAX(IF(s.symbol='VIX6M', y.macd_line, NULL)) as vix6m_macd,
    MAX(IF(s.symbol='VIX6M', y.atr_14, NULL)) as vix6m_atr,
    MAX(IF(s.symbol='VIX6M', y.bb_upper, NULL)) as vix6m_bb_upper,
    MAX(IF(s.symbol='VIX6M', y.momentum_10, NULL)) as vix6m_momentum,
    MAX(IF(s.symbol='VIXM', y.close, NULL)) as vixm_close,
    MAX(IF(s.symbol='VIXM', y.rsi_14, NULL)) as vixm_rsi_14,
    MAX(IF(s.symbol='VIXM', y.ma_30d, NULL)) as vixm_ma_30d,
    MAX(IF(s.symbol='VIXM', y.macd_line, NULL)) as vixm_macd,
    MAX(IF(s.symbol='VIXM', y.atr_14, NULL)) as vixm_atr,
    MAX(IF(s.symbol='VIXM', y.bb_upper, NULL)) as vixm_bb_upper,
    MAX(IF(s.symbol='VIXM', y.momentum_10, NULL)) as vixm_momentum,
    MAX(IF(s.symbol='VIXY', y.close, NULL)) as vixy_close,
    MAX(IF(s.symbol='VIXY', y.rsi_14, NULL)) as vixy_rsi_14,
    MAX(IF(s.symbol='VIXY', y.ma_30d, NULL)) as vixy_ma_30d,
    MAX(IF(s.symbol='VIXY', y.macd_line, NULL)) as vixy_macd,
    MAX(IF(s.symbol='VIXY', y.atr_14, NULL)) as vixy_atr,
    MAX(IF(s.symbol='VIXY', y.bb_upper, NULL)) as vixy_bb_upper,
    MAX(IF(s.symbol='VIXY', y.momentum_10, NULL)) as vixy_momentum,
    MAX(IF(s.symbol='VLO', y.close, NULL)) as vlo_close,
    MAX(IF(s.symbol='VLO', y.rsi_14, NULL)) as vlo_rsi_14,
    MAX(IF(s.symbol='VLO', y.ma_30d, NULL)) as vlo_ma_30d,
    MAX(IF(s.symbol='VLO', y.macd_line, NULL)) as vlo_macd,
    MAX(IF(s.symbol='VLO', y.atr_14, NULL)) as vlo_atr,
    MAX(IF(s.symbol='VLO', y.bb_upper, NULL)) as vlo_bb_upper,
    MAX(IF(s.symbol='VLO', y.momentum_10, NULL)) as vlo_momentum,
    MAX(IF(s.symbol='VOLI', y.close, NULL)) as voli_close,
    MAX(IF(s.symbol='VOLI', y.rsi_14, NULL)) as voli_rsi_14,
    MAX(IF(s.symbol='VOLI', y.ma_30d, NULL)) as voli_ma_30d,
    MAX(IF(s.symbol='VOLI', y.macd_line, NULL)) as voli_macd,
    MAX(IF(s.symbol='VOLI', y.atr_14, NULL)) as voli_atr,
    MAX(IF(s.symbol='VOLI', y.bb_upper, NULL)) as voli_bb_upper,
    MAX(IF(s.symbol='VOLI', y.momentum_10, NULL)) as voli_momentum,
    MAX(IF(s.symbol='VST', y.close, NULL)) as vst_close,
    MAX(IF(s.symbol='VST', y.rsi_14, NULL)) as vst_rsi_14,
    MAX(IF(s.symbol='VST', y.ma_30d, NULL)) as vst_ma_30d,
    MAX(IF(s.symbol='VST', y.macd_line, NULL)) as vst_macd,
    MAX(IF(s.symbol='VST', y.atr_14, NULL)) as vst_atr,
    MAX(IF(s.symbol='VST', y.bb_upper, NULL)) as vst_bb_upper,
    MAX(IF(s.symbol='VST', y.momentum_10, NULL)) as vst_momentum,
    MAX(IF(s.symbol='VTIP', y.close, NULL)) as vtip_close,
    MAX(IF(s.symbol='VTIP', y.rsi_14, NULL)) as vtip_rsi_14,
    MAX(IF(s.symbol='VTIP', y.ma_30d, NULL)) as vtip_ma_30d,
    MAX(IF(s.symbol='VTIP', y.macd_line, NULL)) as vtip_macd,
    MAX(IF(s.symbol='VTIP', y.atr_14, NULL)) as vtip_atr,
    MAX(IF(s.symbol='VTIP', y.bb_upper, NULL)) as vtip_bb_upper,
    MAX(IF(s.symbol='VTIP', y.momentum_10, NULL)) as vtip_momentum,
    MAX(IF(s.symbol='VWOB', y.close, NULL)) as vwob_close,
    MAX(IF(s.symbol='VWOB', y.rsi_14, NULL)) as vwob_rsi_14,
    MAX(IF(s.symbol='VWOB', y.ma_30d, NULL)) as vwob_ma_30d,
    MAX(IF(s.symbol='VWOB', y.macd_line, NULL)) as vwob_macd,
    MAX(IF(s.symbol='VWOB', y.atr_14, NULL)) as vwob_atr,
    MAX(IF(s.symbol='VWOB', y.bb_upper, NULL)) as vwob_bb_upper,
    MAX(IF(s.symbol='VWOB', y.momentum_10, NULL)) as vwob_momentum,
    MAX(IF(s.symbol='VXX', y.close, NULL)) as vxx_close,
    MAX(IF(s.symbol='VXX', y.rsi_14, NULL)) as vxx_rsi_14,
    MAX(IF(s.symbol='VXX', y.ma_30d, NULL)) as vxx_ma_30d,
    MAX(IF(s.symbol='VXX', y.macd_line, NULL)) as vxx_macd,
    MAX(IF(s.symbol='VXX', y.atr_14, NULL)) as vxx_atr,
    MAX(IF(s.symbol='VXX', y.bb_upper, NULL)) as vxx_bb_upper,
    MAX(IF(s.symbol='VXX', y.momentum_10, NULL)) as vxx_momentum,
    MAX(IF(s.symbol='WEAT', y.close, NULL)) as weat_close_yh,
    MAX(IF(s.symbol='WEAT', y.rsi_14, NULL)) as weat_rsi_14_yh,
    MAX(IF(s.symbol='WEAT', y.ma_30d, NULL)) as weat_ma_30d_yh,
    MAX(IF(s.symbol='WEAT', y.macd_line, NULL)) as weat_macd_yh,
    MAX(IF(s.symbol='WEAT', y.atr_14, NULL)) as weat_atr_yh,
    MAX(IF(s.symbol='WEAT', y.bb_upper, NULL)) as weat_bb_upper_yh,
    MAX(IF(s.symbol='WEAT', y.momentum_10, NULL)) as weat_momentum_yh,
    MAX(IF(s.symbol='WILC', y.close, NULL)) as wilc_close,
    MAX(IF(s.symbol='WILC', y.rsi_14, NULL)) as wilc_rsi_14,
    MAX(IF(s.symbol='WILC', y.ma_30d, NULL)) as wilc_ma_30d,
    MAX(IF(s.symbol='WILC', y.macd_line, NULL)) as wilc_macd,
    MAX(IF(s.symbol='WILC', y.atr_14, NULL)) as wilc_atr,
    MAX(IF(s.symbol='WILC', y.bb_upper, NULL)) as wilc_bb_upper,
    MAX(IF(s.symbol='WILC', y.momentum_10, NULL)) as wilc_momentum,
    MAX(IF(s.symbol='WM', y.close, NULL)) as wm_close,
    MAX(IF(s.symbol='WM', y.rsi_14, NULL)) as wm_rsi_14,
    MAX(IF(s.symbol='WM', y.ma_30d, NULL)) as wm_ma_30d,
    MAX(IF(s.symbol='WM', y.macd_line, NULL)) as wm_macd,
    MAX(IF(s.symbol='WM', y.atr_14, NULL)) as wm_atr,
    MAX(IF(s.symbol='WM', y.bb_upper, NULL)) as wm_bb_upper,
    MAX(IF(s.symbol='WM', y.momentum_10, NULL)) as wm_momentum,
    MAX(IF(s.symbol='XLB', y.close, NULL)) as xlb_close,
    MAX(IF(s.symbol='XLB', y.rsi_14, NULL)) as xlb_rsi_14,
    MAX(IF(s.symbol='XLB', y.ma_30d, NULL)) as xlb_ma_30d,
    MAX(IF(s.symbol='XLB', y.macd_line, NULL)) as xlb_macd,
    MAX(IF(s.symbol='XLB', y.atr_14, NULL)) as xlb_atr,
    MAX(IF(s.symbol='XLB', y.bb_upper, NULL)) as xlb_bb_upper,
    MAX(IF(s.symbol='XLB', y.momentum_10, NULL)) as xlb_momentum,
    MAX(IF(s.symbol='XLE', y.close, NULL)) as xle_close,
    MAX(IF(s.symbol='XLE', y.rsi_14, NULL)) as xle_rsi_14,
    MAX(IF(s.symbol='XLE', y.ma_30d, NULL)) as xle_ma_30d,
    MAX(IF(s.symbol='XLE', y.macd_line, NULL)) as xle_macd,
    MAX(IF(s.symbol='XLE', y.atr_14, NULL)) as xle_atr,
    MAX(IF(s.symbol='XLE', y.bb_upper, NULL)) as xle_bb_upper,
    MAX(IF(s.symbol='XLE', y.momentum_10, NULL)) as xle_momentum,
    MAX(IF(s.symbol='XLF', y.close, NULL)) as xlf_close,
    MAX(IF(s.symbol='XLF', y.rsi_14, NULL)) as xlf_rsi_14,
    MAX(IF(s.symbol='XLF', y.ma_30d, NULL)) as xlf_ma_30d,
    MAX(IF(s.symbol='XLF', y.macd_line, NULL)) as xlf_macd,
    MAX(IF(s.symbol='XLF', y.atr_14, NULL)) as xlf_atr,
    MAX(IF(s.symbol='XLF', y.bb_upper, NULL)) as xlf_bb_upper,
    MAX(IF(s.symbol='XLF', y.momentum_10, NULL)) as xlf_momentum,
    MAX(IF(s.symbol='XLI', y.close, NULL)) as xli_close,
    MAX(IF(s.symbol='XLI', y.rsi_14, NULL)) as xli_rsi_14,
    MAX(IF(s.symbol='XLI', y.ma_30d, NULL)) as xli_ma_30d,
    MAX(IF(s.symbol='XLI', y.macd_line, NULL)) as xli_macd,
    MAX(IF(s.symbol='XLI', y.atr_14, NULL)) as xli_atr,
    MAX(IF(s.symbol='XLI', y.bb_upper, NULL)) as xli_bb_upper,
    MAX(IF(s.symbol='XLI', y.momentum_10, NULL)) as xli_momentum,
    MAX(IF(s.symbol='XLK', y.close, NULL)) as xlk_close,
    MAX(IF(s.symbol='XLK', y.rsi_14, NULL)) as xlk_rsi_14,
    MAX(IF(s.symbol='XLK', y.ma_30d, NULL)) as xlk_ma_30d,
    MAX(IF(s.symbol='XLK', y.macd_line, NULL)) as xlk_macd,
    MAX(IF(s.symbol='XLK', y.atr_14, NULL)) as xlk_atr,
    MAX(IF(s.symbol='XLK', y.bb_upper, NULL)) as xlk_bb_upper,
    MAX(IF(s.symbol='XLK', y.momentum_10, NULL)) as xlk_momentum,
    MAX(IF(s.symbol='XLP', y.close, NULL)) as xlp_close,
    MAX(IF(s.symbol='XLP', y.rsi_14, NULL)) as xlp_rsi_14,
    MAX(IF(s.symbol='XLP', y.ma_30d, NULL)) as xlp_ma_30d,
    MAX(IF(s.symbol='XLP', y.macd_line, NULL)) as xlp_macd,
    MAX(IF(s.symbol='XLP', y.atr_14, NULL)) as xlp_atr,
    MAX(IF(s.symbol='XLP', y.bb_upper, NULL)) as xlp_bb_upper,
    MAX(IF(s.symbol='XLP', y.momentum_10, NULL)) as xlp_momentum,
    MAX(IF(s.symbol='XLV', y.close, NULL)) as xlv_close,
    MAX(IF(s.symbol='XLV', y.rsi_14, NULL)) as xlv_rsi_14,
    MAX(IF(s.symbol='XLV', y.ma_30d, NULL)) as xlv_ma_30d,
    MAX(IF(s.symbol='XLV', y.macd_line, NULL)) as xlv_macd,
    MAX(IF(s.symbol='XLV', y.atr_14, NULL)) as xlv_atr,
    MAX(IF(s.symbol='XLV', y.bb_upper, NULL)) as xlv_bb_upper,
    MAX(IF(s.symbol='XLV', y.momentum_10, NULL)) as xlv_momentum,
    MAX(IF(s.symbol='XLY', y.close, NULL)) as xly_close,
    MAX(IF(s.symbol='XLY', y.rsi_14, NULL)) as xly_rsi_14,
    MAX(IF(s.symbol='XLY', y.ma_30d, NULL)) as xly_ma_30d,
    MAX(IF(s.symbol='XLY', y.macd_line, NULL)) as xly_macd,
    MAX(IF(s.symbol='XLY', y.atr_14, NULL)) as xly_atr,
    MAX(IF(s.symbol='XLY', y.bb_upper, NULL)) as xly_bb_upper,
    MAX(IF(s.symbol='XLY', y.momentum_10, NULL)) as xly_momentum,
    MAX(IF(s.symbol='XME', y.close, NULL)) as xme_close,
    MAX(IF(s.symbol='XME', y.rsi_14, NULL)) as xme_rsi_14,
    MAX(IF(s.symbol='XME', y.ma_30d, NULL)) as xme_ma_30d,
    MAX(IF(s.symbol='XME', y.macd_line, NULL)) as xme_macd,
    MAX(IF(s.symbol='XME', y.atr_14, NULL)) as xme_atr,
    MAX(IF(s.symbol='XME', y.bb_upper, NULL)) as xme_bb_upper,
    MAX(IF(s.symbol='XME', y.momentum_10, NULL)) as xme_momentum,
    MAX(IF(s.symbol='XOM', y.close, NULL)) as xom_close,
    MAX(IF(s.symbol='XOM', y.rsi_14, NULL)) as xom_rsi_14,
    MAX(IF(s.symbol='XOM', y.ma_30d, NULL)) as xom_ma_30d,
    MAX(IF(s.symbol='XOM', y.macd_line, NULL)) as xom_macd,
    MAX(IF(s.symbol='XOM', y.atr_14, NULL)) as xom_atr,
    MAX(IF(s.symbol='XOM', y.bb_upper, NULL)) as xom_bb_upper,
    MAX(IF(s.symbol='XOM', y.momentum_10, NULL)) as xom_momentum,
    MAX(IF(s.symbol='XOP', y.close, NULL)) as xop_close,
    MAX(IF(s.symbol='XOP', y.rsi_14, NULL)) as xop_rsi_14,
    MAX(IF(s.symbol='XOP', y.ma_30d, NULL)) as xop_ma_30d,
    MAX(IF(s.symbol='XOP', y.macd_line, NULL)) as xop_macd,
    MAX(IF(s.symbol='XOP', y.atr_14, NULL)) as xop_atr,
    MAX(IF(s.symbol='XOP', y.bb_upper, NULL)) as xop_bb_upper,
    MAX(IF(s.symbol='XOP', y.momentum_10, NULL)) as xop_momentum,
    MAX(IF(s.symbol='ZARUSD=X', y.close, NULL)) as zarusd_x_close,
    MAX(IF(s.symbol='ZARUSD=X', y.rsi_14, NULL)) as zarusd_x_rsi_14,
    MAX(IF(s.symbol='ZARUSD=X', y.ma_30d, NULL)) as zarusd_x_ma_30d,
    MAX(IF(s.symbol='ZARUSD=X', y.macd_line, NULL)) as zarusd_x_macd,
    MAX(IF(s.symbol='ZARUSD=X', y.atr_14, NULL)) as zarusd_x_atr,
    MAX(IF(s.symbol='ZARUSD=X', y.bb_upper, NULL)) as zarusd_x_bb_upper,
    MAX(IF(s.symbol='ZARUSD=X', y.momentum_10, NULL)) as zarusd_x_momentum,
    MAX(IF(s.symbol='ZC=F', y.close, NULL)) as zc_f_close,
    MAX(IF(s.symbol='ZC=F', y.rsi_14, NULL)) as zc_f_rsi_14,
    MAX(IF(s.symbol='ZC=F', y.ma_30d, NULL)) as zc_f_ma_30d,
    MAX(IF(s.symbol='ZC=F', y.macd_line, NULL)) as zc_f_macd,
    MAX(IF(s.symbol='ZC=F', y.atr_14, NULL)) as zc_f_atr,
    MAX(IF(s.symbol='ZC=F', y.bb_upper, NULL)) as zc_f_bb_upper,
    MAX(IF(s.symbol='ZC=F', y.momentum_10, NULL)) as zc_f_momentum,
    MAX(IF(s.symbol='ZL=F', y.close, NULL)) as zl_f_close,
    MAX(IF(s.symbol='ZL=F', y.rsi_14, NULL)) as zl_f_rsi_14,
    MAX(IF(s.symbol='ZL=F', y.ma_30d, NULL)) as zl_f_ma_30d,
    MAX(IF(s.symbol='ZL=F', y.macd_line, NULL)) as zl_f_macd,
    MAX(IF(s.symbol='ZL=F', y.atr_14, NULL)) as zl_f_atr,
    MAX(IF(s.symbol='ZL=F', y.bb_upper, NULL)) as zl_f_bb_upper,
    MAX(IF(s.symbol='ZL=F', y.momentum_10, NULL)) as zl_f_momentum,
    MAX(IF(s.symbol='ZM=F', y.close, NULL)) as zm_f_close,
    MAX(IF(s.symbol='ZM=F', y.rsi_14, NULL)) as zm_f_rsi_14,
    MAX(IF(s.symbol='ZM=F', y.ma_30d, NULL)) as zm_f_ma_30d,
    MAX(IF(s.symbol='ZM=F', y.macd_line, NULL)) as zm_f_macd,
    MAX(IF(s.symbol='ZM=F', y.atr_14, NULL)) as zm_f_atr,
    MAX(IF(s.symbol='ZM=F', y.bb_upper, NULL)) as zm_f_bb_upper,
    MAX(IF(s.symbol='ZM=F', y.momentum_10, NULL)) as zm_f_momentum,
    MAX(IF(s.symbol='ZO=F', y.close, NULL)) as zo_f_close,
    MAX(IF(s.symbol='ZO=F', y.rsi_14, NULL)) as zo_f_rsi_14,
    MAX(IF(s.symbol='ZO=F', y.ma_30d, NULL)) as zo_f_ma_30d,
    MAX(IF(s.symbol='ZO=F', y.macd_line, NULL)) as zo_f_macd,
    MAX(IF(s.symbol='ZO=F', y.atr_14, NULL)) as zo_f_atr,
    MAX(IF(s.symbol='ZO=F', y.bb_upper, NULL)) as zo_f_bb_upper,
    MAX(IF(s.symbol='ZO=F', y.momentum_10, NULL)) as zo_f_momentum,
    MAX(IF(s.symbol='ZR=F', y.close, NULL)) as zr_f_close,
    MAX(IF(s.symbol='ZR=F', y.rsi_14, NULL)) as zr_f_rsi_14,
    MAX(IF(s.symbol='ZR=F', y.ma_30d, NULL)) as zr_f_ma_30d,
    MAX(IF(s.symbol='ZR=F', y.macd_line, NULL)) as zr_f_macd,
    MAX(IF(s.symbol='ZR=F', y.atr_14, NULL)) as zr_f_atr,
    MAX(IF(s.symbol='ZR=F', y.bb_upper, NULL)) as zr_f_bb_upper,
    MAX(IF(s.symbol='ZR=F', y.momentum_10, NULL)) as zr_f_momentum,
    MAX(IF(s.symbol='ZS=F', y.close, NULL)) as zs_f_close,
    MAX(IF(s.symbol='ZS=F', y.rsi_14, NULL)) as zs_f_rsi_14,
    MAX(IF(s.symbol='ZS=F', y.ma_30d, NULL)) as zs_f_ma_30d,
    MAX(IF(s.symbol='ZS=F', y.macd_line, NULL)) as zs_f_macd,
    MAX(IF(s.symbol='ZS=F', y.atr_14, NULL)) as zs_f_atr,
    MAX(IF(s.symbol='ZS=F', y.bb_upper, NULL)) as zs_f_bb_upper,
    MAX(IF(s.symbol='ZS=F', y.momentum_10, NULL)) as zs_f_momentum,
    MAX(IF(s.symbol='ZW=F', y.close, NULL)) as zw_f_close,
    MAX(IF(s.symbol='ZW=F', y.rsi_14, NULL)) as zw_f_rsi_14,
    MAX(IF(s.symbol='ZW=F', y.ma_30d, NULL)) as zw_f_ma_30d,
    MAX(IF(s.symbol='ZW=F', y.macd_line, NULL)) as zw_f_macd,
    MAX(IF(s.symbol='ZW=F', y.atr_14, NULL)) as zw_f_atr,
    MAX(IF(s.symbol='ZW=F', y.bb_upper, NULL)) as zw_f_bb_upper,
    MAX(IF(s.symbol='ZW=F', y.momentum_10, NULL)) as zw_f_momentum,
    MAX(IF(s.symbol='^CPCE', y.close, NULL)) as cpce_close,
    MAX(IF(s.symbol='^CPCE', y.rsi_14, NULL)) as cpce_rsi_14,
    MAX(IF(s.symbol='^CPCE', y.ma_30d, NULL)) as cpce_ma_30d,
    MAX(IF(s.symbol='^CPCE', y.macd_line, NULL)) as cpce_macd,
    MAX(IF(s.symbol='^CPCE', y.atr_14, NULL)) as cpce_atr,
    MAX(IF(s.symbol='^CPCE', y.bb_upper, NULL)) as cpce_bb_upper,
    MAX(IF(s.symbol='^CPCE', y.momentum_10, NULL)) as cpce_momentum,
    MAX(IF(s.symbol='^CPCI', y.close, NULL)) as cpci_close,
    MAX(IF(s.symbol='^CPCI', y.rsi_14, NULL)) as cpci_rsi_14,
    MAX(IF(s.symbol='^CPCI', y.ma_30d, NULL)) as cpci_ma_30d,
    MAX(IF(s.symbol='^CPCI', y.macd_line, NULL)) as cpci_macd,
    MAX(IF(s.symbol='^CPCI', y.atr_14, NULL)) as cpci_atr,
    MAX(IF(s.symbol='^CPCI', y.bb_upper, NULL)) as cpci_bb_upper,
    MAX(IF(s.symbol='^CPCI', y.momentum_10, NULL)) as cpci_momentum,
    MAX(IF(s.symbol='^DJI', y.close, NULL)) as dji_close,
    MAX(IF(s.symbol='^DJI', y.rsi_14, NULL)) as dji_rsi_14,
    MAX(IF(s.symbol='^DJI', y.ma_30d, NULL)) as dji_ma_30d,
    MAX(IF(s.symbol='^DJI', y.macd_line, NULL)) as dji_macd,
    MAX(IF(s.symbol='^DJI', y.atr_14, NULL)) as dji_atr,
    MAX(IF(s.symbol='^DJI', y.bb_upper, NULL)) as dji_bb_upper,
    MAX(IF(s.symbol='^DJI', y.momentum_10, NULL)) as dji_momentum,
    MAX(IF(s.symbol='^EVZ', y.close, NULL)) as evz_close,
    MAX(IF(s.symbol='^EVZ', y.rsi_14, NULL)) as evz_rsi_14,
    MAX(IF(s.symbol='^EVZ', y.ma_30d, NULL)) as evz_ma_30d,
    MAX(IF(s.symbol='^EVZ', y.macd_line, NULL)) as evz_macd,
    MAX(IF(s.symbol='^EVZ', y.atr_14, NULL)) as evz_atr,
    MAX(IF(s.symbol='^EVZ', y.bb_upper, NULL)) as evz_bb_upper,
    MAX(IF(s.symbol='^EVZ', y.momentum_10, NULL)) as evz_momentum,
    MAX(IF(s.symbol='^FVX', y.close, NULL)) as fvx_close,
    MAX(IF(s.symbol='^FVX', y.rsi_14, NULL)) as fvx_rsi_14,
    MAX(IF(s.symbol='^FVX', y.ma_30d, NULL)) as fvx_ma_30d,
    MAX(IF(s.symbol='^FVX', y.macd_line, NULL)) as fvx_macd,
    MAX(IF(s.symbol='^FVX', y.atr_14, NULL)) as fvx_atr,
    MAX(IF(s.symbol='^FVX', y.bb_upper, NULL)) as fvx_bb_upper,
    MAX(IF(s.symbol='^FVX', y.momentum_10, NULL)) as fvx_momentum,
    MAX(IF(s.symbol='^GSPC', y.close, NULL)) as gspc_close_yh,
    MAX(IF(s.symbol='^GSPC', y.rsi_14, NULL)) as gspc_rsi_14_yh,
    MAX(IF(s.symbol='^GSPC', y.ma_30d, NULL)) as gspc_ma_30d_yh,
    MAX(IF(s.symbol='^GSPC', y.macd_line, NULL)) as gspc_macd_yh,
    MAX(IF(s.symbol='^GSPC', y.atr_14, NULL)) as gspc_atr_yh,
    MAX(IF(s.symbol='^GSPC', y.bb_upper, NULL)) as gspc_bb_upper_yh,
    MAX(IF(s.symbol='^GSPC', y.momentum_10, NULL)) as gspc_momentum_yh,
    MAX(IF(s.symbol='^GVZ', y.close, NULL)) as gvz_close,
    MAX(IF(s.symbol='^GVZ', y.rsi_14, NULL)) as gvz_rsi_14,
    MAX(IF(s.symbol='^GVZ', y.ma_30d, NULL)) as gvz_ma_30d,
    MAX(IF(s.symbol='^GVZ', y.macd_line, NULL)) as gvz_macd,
    MAX(IF(s.symbol='^GVZ', y.atr_14, NULL)) as gvz_atr,
    MAX(IF(s.symbol='^GVZ', y.bb_upper, NULL)) as gvz_bb_upper,
    MAX(IF(s.symbol='^GVZ', y.momentum_10, NULL)) as gvz_momentum,
    MAX(IF(s.symbol='^IRX', y.close, NULL)) as irx_close,
    MAX(IF(s.symbol='^IRX', y.rsi_14, NULL)) as irx_rsi_14,
    MAX(IF(s.symbol='^IRX', y.ma_30d, NULL)) as irx_ma_30d,
    MAX(IF(s.symbol='^IRX', y.macd_line, NULL)) as irx_macd,
    MAX(IF(s.symbol='^IRX', y.atr_14, NULL)) as irx_atr,
    MAX(IF(s.symbol='^IRX', y.bb_upper, NULL)) as irx_bb_upper,
    MAX(IF(s.symbol='^IRX', y.momentum_10, NULL)) as irx_momentum,
    MAX(IF(s.symbol='^IXIC', y.close, NULL)) as ixic_close,
    MAX(IF(s.symbol='^IXIC', y.rsi_14, NULL)) as ixic_rsi_14,
    MAX(IF(s.symbol='^IXIC', y.ma_30d, NULL)) as ixic_ma_30d,
    MAX(IF(s.symbol='^IXIC', y.macd_line, NULL)) as ixic_macd,
    MAX(IF(s.symbol='^IXIC', y.atr_14, NULL)) as ixic_atr,
    MAX(IF(s.symbol='^IXIC', y.bb_upper, NULL)) as ixic_bb_upper,
    MAX(IF(s.symbol='^IXIC', y.momentum_10, NULL)) as ixic_momentum,
    MAX(IF(s.symbol='^OVX', y.close, NULL)) as ovx_close,
    MAX(IF(s.symbol='^OVX', y.rsi_14, NULL)) as ovx_rsi_14,
    MAX(IF(s.symbol='^OVX', y.ma_30d, NULL)) as ovx_ma_30d,
    MAX(IF(s.symbol='^OVX', y.macd_line, NULL)) as ovx_macd,
    MAX(IF(s.symbol='^OVX', y.atr_14, NULL)) as ovx_atr,
    MAX(IF(s.symbol='^OVX', y.bb_upper, NULL)) as ovx_bb_upper,
    MAX(IF(s.symbol='^OVX', y.momentum_10, NULL)) as ovx_momentum,
    MAX(IF(s.symbol='^RUT', y.close, NULL)) as rut_close,
    MAX(IF(s.symbol='^RUT', y.rsi_14, NULL)) as rut_rsi_14,
    MAX(IF(s.symbol='^RUT', y.ma_30d, NULL)) as rut_ma_30d,
    MAX(IF(s.symbol='^RUT', y.macd_line, NULL)) as rut_macd,
    MAX(IF(s.symbol='^RUT', y.atr_14, NULL)) as rut_atr,
    MAX(IF(s.symbol='^RUT', y.bb_upper, NULL)) as rut_bb_upper,
    MAX(IF(s.symbol='^RUT', y.momentum_10, NULL)) as rut_momentum,
    MAX(IF(s.symbol='^RVX', y.close, NULL)) as rvx_close,
    MAX(IF(s.symbol='^RVX', y.rsi_14, NULL)) as rvx_rsi_14,
    MAX(IF(s.symbol='^RVX', y.ma_30d, NULL)) as rvx_ma_30d,
    MAX(IF(s.symbol='^RVX', y.macd_line, NULL)) as rvx_macd,
    MAX(IF(s.symbol='^RVX', y.atr_14, NULL)) as rvx_atr,
    MAX(IF(s.symbol='^RVX', y.bb_upper, NULL)) as rvx_bb_upper,
    MAX(IF(s.symbol='^RVX', y.momentum_10, NULL)) as rvx_momentum,
    MAX(IF(s.symbol='^SKEW', y.close, NULL)) as skew_close,
    MAX(IF(s.symbol='^SKEW', y.rsi_14, NULL)) as skew_rsi_14,
    MAX(IF(s.symbol='^SKEW', y.ma_30d, NULL)) as skew_ma_30d,
    MAX(IF(s.symbol='^SKEW', y.macd_line, NULL)) as skew_macd,
    MAX(IF(s.symbol='^SKEW', y.atr_14, NULL)) as skew_atr,
    MAX(IF(s.symbol='^SKEW', y.bb_upper, NULL)) as skew_bb_upper,
    MAX(IF(s.symbol='^SKEW', y.momentum_10, NULL)) as skew_momentum,
    MAX(IF(s.symbol='^TNX', y.close, NULL)) as tnx_close,
    MAX(IF(s.symbol='^TNX', y.rsi_14, NULL)) as tnx_rsi_14,
    MAX(IF(s.symbol='^TNX', y.ma_30d, NULL)) as tnx_ma_30d,
    MAX(IF(s.symbol='^TNX', y.macd_line, NULL)) as tnx_macd,
    MAX(IF(s.symbol='^TNX', y.atr_14, NULL)) as tnx_atr,
    MAX(IF(s.symbol='^TNX', y.bb_upper, NULL)) as tnx_bb_upper,
    MAX(IF(s.symbol='^TNX', y.momentum_10, NULL)) as tnx_momentum,
    MAX(IF(s.symbol='^TYX', y.close, NULL)) as tyx_close,
    MAX(IF(s.symbol='^TYX', y.rsi_14, NULL)) as tyx_rsi_14,
    MAX(IF(s.symbol='^TYX', y.ma_30d, NULL)) as tyx_ma_30d,
    MAX(IF(s.symbol='^TYX', y.macd_line, NULL)) as tyx_macd,
    MAX(IF(s.symbol='^TYX', y.atr_14, NULL)) as tyx_atr,
    MAX(IF(s.symbol='^TYX', y.bb_upper, NULL)) as tyx_bb_upper,
    MAX(IF(s.symbol='^TYX', y.momentum_10, NULL)) as tyx_momentum,
    MAX(IF(s.symbol='^VIX', y.close, NULL)) as vix_close,
    MAX(IF(s.symbol='^VIX', y.rsi_14, NULL)) as vix_rsi_14,
    MAX(IF(s.symbol='^VIX', y.ma_30d, NULL)) as vix_ma_30d,
    MAX(IF(s.symbol='^VIX', y.macd_line, NULL)) as vix_macd,
    MAX(IF(s.symbol='^VIX', y.atr_14, NULL)) as vix_atr,
    MAX(IF(s.symbol='^VIX', y.bb_upper, NULL)) as vix_bb_upper,
    MAX(IF(s.symbol='^VIX', y.momentum_10, NULL)) as vix_momentum,
    MAX(IF(s.symbol='^VVIX', y.close, NULL)) as vvix_close,
    MAX(IF(s.symbol='^VVIX', y.rsi_14, NULL)) as vvix_rsi_14,
    MAX(IF(s.symbol='^VVIX', y.ma_30d, NULL)) as vvix_ma_30d,
    MAX(IF(s.symbol='^VVIX', y.macd_line, NULL)) as vvix_macd,
    MAX(IF(s.symbol='^VVIX', y.atr_14, NULL)) as vvix_atr,
    MAX(IF(s.symbol='^VVIX', y.bb_upper, NULL)) as vvix_bb_upper,
    MAX(IF(s.symbol='^VVIX', y.momentum_10, NULL)) as vvix_momentum,
    MAX(IF(s.symbol='^VXD', y.close, NULL)) as vxd_close,
    MAX(IF(s.symbol='^VXD', y.rsi_14, NULL)) as vxd_rsi_14,
    MAX(IF(s.symbol='^VXD', y.ma_30d, NULL)) as vxd_ma_30d,
    MAX(IF(s.symbol='^VXD', y.macd_line, NULL)) as vxd_macd,
    MAX(IF(s.symbol='^VXD', y.atr_14, NULL)) as vxd_atr,
    MAX(IF(s.symbol='^VXD', y.bb_upper, NULL)) as vxd_bb_upper,
    MAX(IF(s.symbol='^VXD', y.momentum_10, NULL)) as vxd_momentum,
    MAX(IF(s.symbol='^VXN', y.close, NULL)) as vxn_close,
    MAX(IF(s.symbol='^VXN', y.rsi_14, NULL)) as vxn_rsi_14,
    MAX(IF(s.symbol='^VXN', y.ma_30d, NULL)) as vxn_ma_30d,
    MAX(IF(s.symbol='^VXN', y.macd_line, NULL)) as vxn_macd,
    MAX(IF(s.symbol='^VXN', y.atr_14, NULL)) as vxn_atr,
    MAX(IF(s.symbol='^VXN', y.bb_upper, NULL)) as vxn_bb_upper,
    MAX(IF(s.symbol='^VXN', y.momentum_10, NULL)) as vxn_momentum
  FROM date_list d
  CROSS JOIN symbol_list s
  LEFT JOIN yahoo_data y ON d.date = y.date AND s.symbol = y.symbol
  GROUP BY d.date
),

-- Rolling correlations for top symbols vs zl_price_current
-- Using 7d, 30d, 90d, 180d windows (skip 365d - not enough data in 2-year window)
correlations AS (
  SELECT
    p.date,
    -- SOYB correlations (use production version since Yahoo version excluded)
    CORR(p.soyb_close, p.zl_price_current) OVER (ORDER BY p.date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) as corr_soyb_zl_7d,
    CORR(p.soyb_close, p.zl_price_current) OVER (ORDER BY p.date ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) as corr_soyb_zl_30d,
    CORR(p.soyb_close, p.zl_price_current) OVER (ORDER BY p.date ROWS BETWEEN 89 PRECEDING AND CURRENT ROW) as corr_soyb_zl_90d,
    CORR(p.soyb_close, p.zl_price_current) OVER (ORDER BY p.date ROWS BETWEEN 179 PRECEDING AND CURRENT ROW) as corr_soyb_zl_180d,
    
    -- CORN correlations (use production version since Yahoo version excluded)
    CORR(p.corn_etf_close, p.zl_price_current) OVER (ORDER BY p.date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) as corr_corn_zl_7d,
    CORR(p.corn_etf_close, p.zl_price_current) OVER (ORDER BY p.date ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) as corr_corn_zl_30d,
    CORR(p.corn_etf_close, p.zl_price_current) OVER (ORDER BY p.date ROWS BETWEEN 89 PRECEDING AND CURRENT ROW) as corr_corn_zl_90d,
    CORR(p.corn_etf_close, p.zl_price_current) OVER (ORDER BY p.date ROWS BETWEEN 179 PRECEDING AND CURRENT ROW) as corr_corn_zl_180d,
    
    -- CL=F correlations (column is cl_f_close_yh)
    CORR(y.cl_f_close_yh, p.zl_price_current) OVER (ORDER BY p.date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) as corr_cl_zl_7d,
    CORR(y.cl_f_close_yh, p.zl_price_current) OVER (ORDER BY p.date ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) as corr_cl_zl_30d,
    CORR(y.cl_f_close_yh, p.zl_price_current) OVER (ORDER BY p.date ROWS BETWEEN 89 PRECEDING AND CURRENT ROW) as corr_cl_zl_90d,
    CORR(y.cl_f_close_yh, p.zl_price_current) OVER (ORDER BY p.date ROWS BETWEEN 179 PRECEDING AND CURRENT ROW) as corr_cl_zl_180d,
    
    -- DXY correlations (symbol is DX-Y.NYB, column is dx_y_nyb_close)
    CORR(y.dx_y_nyb_close, p.zl_price_current) OVER (ORDER BY p.date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) as corr_dxy_zl_7d,
    CORR(y.dx_y_nyb_close, p.zl_price_current) OVER (ORDER BY p.date ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) as corr_dxy_zl_30d,
    CORR(y.dx_y_nyb_close, p.zl_price_current) OVER (ORDER BY p.date ROWS BETWEEN 89 PRECEDING AND CURRENT ROW) as corr_dxy_zl_90d,
    CORR(y.dx_y_nyb_close, p.zl_price_current) OVER (ORDER BY p.date ROWS BETWEEN 179 PRECEDING AND CURRENT ROW) as corr_dxy_zl_180d,
    
    -- VIX correlations (symbol is ^VIX, column is vix_close)
    CORR(y.vix_close, p.zl_price_current) OVER (ORDER BY p.date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) as corr_vix_zl_7d,
    CORR(y.vix_close, p.zl_price_current) OVER (ORDER BY p.date ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) as corr_vix_zl_30d,
    CORR(y.vix_close, p.zl_price_current) OVER (ORDER BY p.date ROWS BETWEEN 89 PRECEDING AND CURRENT ROW) as corr_vix_zl_90d,
    CORR(y.vix_close, p.zl_price_current) OVER (ORDER BY p.date ROWS BETWEEN 179 PRECEDING AND CURRENT ROW) as corr_vix_zl_180d
    
    -- NOTE: Add correlations for remaining top 50 symbols as needed
    -- Full version would have ~200 correlation features (50 symbols × 4 windows)
    
  FROM base_production p
  LEFT JOIN yahoo_pivoted y ON p.date = y.date
  WHERE p.date >= '2024-01-01'
),

-- Interaction features (spreads, ratios, relative strength)
interactions AS (
  SELECT
    p.date,
    
    -- Spreads (use production versions for excluded symbols, Yahoo for others)
    p.soyb_close - p.corn_etf_close as soyb_corn_spread,
    p.soyb_close - p.weat_close as soyb_weat_spread,
    y.cl_f_close_yh - y.bz_f_close_yh as wti_brent_spread,
    p.adm_close - p.bg_close as adm_bg_spread,
    
    -- Ratios
    p.soyb_close / NULLIF(p.corn_etf_close, 0) as soyb_corn_ratio,
    y.cl_f_close_yh / NULLIF(y.dx_y_nyb_close, 0) as crude_dxy_ratio,
    y.vix_close / NULLIF(y.gspc_close_yh, 0) as vix_spx_ratio,
    
    -- Relative strength
    p.soyb_rsi_14 - p.corn_etf_rsi_14 as soyb_corn_rsi_diff,
    p.adm_close - p.bg_close as adm_bg_spread_rsi,
    
    -- Volatility ratios
    p.soyb_atr_14 / NULLIF(y.vix_close, 0) as soyb_vol_to_vix,
    y.cl_f_atr_yh / NULLIF(y.vix_close, 0) as crude_vol_to_vix,
    
    -- Regime indicators
    CASE WHEN y.vix_close > 20 THEN 1 ELSE 0 END as vix_high_regime,
    CASE WHEN y.dx_y_nyb_close > AVG(y.dx_y_nyb_close) OVER (ORDER BY p.date ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) THEN 1 ELSE 0 END as dollar_strength_regime,
    CASE WHEN y.cl_f_close_yh > AVG(y.cl_f_close_yh) OVER (ORDER BY p.date ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) THEN 1 ELSE 0 END as crude_strength_regime
    
  FROM base_production p
  LEFT JOIN yahoo_pivoted y ON p.date = y.date
  WHERE p.date >= '2024-01-01'
)

-- Final comprehensive table
-- Keep ALL production data (p.*) - do not exclude anything
-- Only exclude conflicting columns from Yahoo (y.*) to preserve production versions
SELECT
  p.*,
  y.* EXCEPT(date),
  c.* EXCEPT(date),
  i.* EXCEPT(date)
FROM base_production p
LEFT JOIN yahoo_pivoted y ON p.date = y.date
LEFT JOIN correlations c ON p.date = c.date
LEFT JOIN interactions i ON p.date = i.date;

-- ============================================
-- STEP 2: TRAIN BASELINE MODEL
-- ============================================

CREATE OR REPLACE MODEL `cbi-v14.models_v4.bqml_1m_baseline_exploratory_220_symbols`
OPTIONS(
  model_type='BOOSTED_TREE_REGRESSOR',
  input_label_cols=['target_1m'],
  max_iterations=300,              -- TRIPLE: Allow full convergence (was 50, stopped early)
  learn_rate=0.12,                -- 2.4× faster: Faster convergence (was 0.05)
  early_stop=TRUE,                 -- Keep safety net
  min_rel_progress=0.00001,        -- 10× tighter: 0.001% threshold (was 0.0001)
  -- REGULARIZATION: Adjusted for 2,200+ features with 220 symbols
  -- L1=0.7: Looser to keep more Yahoo features (was 1.5, too aggressive)
  -- L2=0.3: Looser regularization (was 0.5)
  l1_reg=0.7,                      -- Looser – keep more Yahoo signals
  l2_reg=0.3,                      -- Looser regularization
  subsample=0.8,
  max_tree_depth=10,
  data_split_method='SEQ',         -- FIXED: Time-aware split (was 'RANDOM')
  data_split_col='date',           -- NEW: Explicitly specify time column
  data_split_eval_fraction=0.2     -- 20% holdout for validation
) AS
SELECT 
  target_1m,  -- BQML automatically uses this as label
  date,  -- Required for data_split_col, but will be excluded from features
  * EXCEPT(
    -- Exclude other targets
    target_1w,
    target_1m,  -- Exclude from features (but keep above for label)
    target_3m,
    target_6m,
    -- Note: date is included above for data_split_col but excluded here from features
    date,
    -- Exclude string columns
    yahoo_data_source,
    volatility_regime,
    -- Exclude 100% NULL columns (complete list from V2/V3/V4 validation)
    social_sentiment_volatility,
    news_article_count,
    news_avg_score,
    news_sentiment_avg,
    china_news_count,
    biofuel_news_count,
    tariff_news_count,
    weather_news_count,
    news_intelligence_7d,
    news_volume_7d,
    china_weekly_cancellations_mt,
    argentina_vessel_queue_count,
    argentina_port_throughput_teu,
    baltic_dry_index,
    heating_oil_price,
    natural_gas_price,
    gasoline_price,
    sugar_price,
    icln_price,
    tan_price,
    dba_price,
    vegi_price,
    biodiesel_spread_ma30,
    ethanol_spread_ma30,
    biodiesel_spread_vol,
    ethanol_spread_vol,
    -- Analyst target columns (100% NULL)
    adm_analyst_target,
    bg_analyst_target,
    bg_beta,
    cf_analyst_target,
    dar_analyst_target,
    mos_analyst_target,
    ntr_analyst_target,
    tsn_analyst_target,
    -- Additional 100% NULL columns (will be expanded as errors occur)
    trump_soybean_sentiment_7d,
    agg_close
  )
FROM `cbi-v14.models_v4.full_220_comprehensive_2yr`
WHERE target_1m IS NOT NULL
  AND date >= '2024-01-01';

-- ============================================
-- STEP 3: EVALUATE MODEL
-- ============================================

-- Evaluate on 2024+ test data
SELECT 
  'bqml_1m_baseline_exploratory_220_symbols' as model_name,
  *
FROM ML.EVALUATE(
  MODEL `cbi-v14.models_v4.bqml_1m_baseline_exploratory_220_symbols`,
  (
    SELECT * FROM `cbi-v14.models_v4.full_220_comprehensive_2yr`
    WHERE target_1m IS NOT NULL
      AND date >= '2024-01-01'
  )
);

-- ============================================
-- STEP 4: EXTRACT FEATURE IMPORTANCE
-- ============================================

-- Get top 100 most important features
SELECT 
  feature,
  importance,
  ROUND(importance * 100, 4) as importance_pct
FROM ML.FEATURE_IMPORTANCE(
  MODEL `cbi-v14.models_v4.bqml_1m_baseline_exploratory_220_symbols`
)
ORDER BY importance DESC
LIMIT 100;

-- ============================================
-- VERIFICATION QUERIES
-- ============================================

-- Check table was created
SELECT 
  'full_220_comprehensive_2yr' as table_name,
  COUNT(*) as total_rows,
  MIN(date) as earliest_date,
  MAX(date) as latest_date,
  COUNTIF(target_1m IS NOT NULL) as rows_with_target
FROM `cbi-v14.models_v4.full_220_comprehensive_2yr`;

-- Check model was created
SELECT 
  model_name,
  creation_time,
  model_type,
  TIMESTAMP_DIFF(CURRENT_TIMESTAMP(), creation_time, MINUTE) as minutes_old
FROM `cbi-v14.models_v4.INFORMATION_SCHEMA.MODELS`
WHERE model_name = 'bqml_1m_baseline_exploratory_220_symbols';

-- Check training info
SELECT 
  iteration,
  training_loss,
  evaluation_loss,
  learning_rate,
  duration_ms
FROM ML.TRAINING_INFO(
  MODEL `cbi-v14.models_v4.bqml_1m_baseline_exploratory_220_symbols`
)
ORDER BY iteration DESC
LIMIT 10;

-- ============================================
-- STEP 5: TRAIN DART QUANTILE MODELS (p10, p50, p90)
-- ============================================
-- v5.5 DART TRIO – ALL OPTIMIZATIONS APPLIED
-- These models provide quantile predictions for risk bands

-- p10 (downside risk - 10% quantile)
CREATE OR REPLACE MODEL `cbi-v14.models_v4.bqml_1m_v5_5_dart_p10`
OPTIONS(
  model_type='BOOSTED_TREE_REGRESSOR',
  booster_type='DART',                 -- BQML DART = dropout trees
  num_parallel_tree=8,                 -- Reduced from 12 for better runtime (was 12)
  dart_drop_rate=0.15,
  dart_skip_drop=0.4,
  max_tree_depth=12,                   -- Reduced from 16 (was 16)
  learn_rate=0.09,
  l1_reg=0.5,
  l2_reg=0.2,
  subsample=0.85,
  colsample_bytree=0.75,
  quantile_alpha=0.1,                  -- 10% quantile
  early_stop=TRUE,
  min_rel_progress=0.00005,
  max_iterations=250,
  data_split_method='SEQ',
  data_split_col='date',
  data_split_eval_fraction=0.2,
  monotone_constraints = [
    ('rin_d4_price', -1),          -- higher RIN → lower ZL (use production RIN D4)
    ('ho_f_yh_close', -1),        -- higher diesel → lower ZL
    ('zl_f_rsi_14', 1),           -- higher RSI → higher ZL (momentum) - ZL=F not in conflicts
    ('adm_close_yh', 1),          -- higher processor price → higher crush (use close, volume not in pivot)
    ('dxy_close_yh', -1)          -- stronger USD → lower ZL exports
  ]
) AS
SELECT 
  target_1m AS label,
  date,  -- Required for data_split_col
  * EXCEPT(date, target_1m, label)
FROM `cbi-v14.models_v4.full_220_comprehensive_2yr`
WHERE target_1m IS NOT NULL
  AND date >= '2024-01-01';

-- p50 (median – our point forecast)
CREATE OR REPLACE MODEL `cbi-v14.models_v4.bqml_1m_v5_5_dart_p50`
OPTIONS(
  model_type='BOOSTED_TREE_REGRESSOR',
  booster_type='DART',
  num_parallel_tree=8,
  dart_drop_rate=0.15,
  dart_skip_drop=0.4,
  max_tree_depth=12,
  learn_rate=0.09,
  l1_reg=0.5,
  l2_reg=0.2,
  subsample=0.85,
  colsample_bytree=0.75,
  quantile_alpha=0.5,                  -- 50% quantile (median)
  early_stop=TRUE,
  min_rel_progress=0.00005,
  max_iterations=250,
  data_split_method='SEQ',
  data_split_col='date',
  data_split_eval_fraction=0.2,
  monotone_constraints = [
    ('xb_f_close', -1),
    ('ho_f_yh_close', -1),
    ('zl_f_yh_rsi_14', 1),
    ('adm_yh_volume', 1),
    ('dxy_close', -1)
  ]
) AS
SELECT 
  target_1m,  -- BQML automatically uses this as label
  date,  -- Required for data_split_col
  * EXCEPT(date, target_1m)
FROM `cbi-v14.models_v4.full_220_comprehensive_2yr`
WHERE target_1m IS NOT NULL
  AND date >= '2024-01-01';

-- p90 (upside risk - 90% quantile)
CREATE OR REPLACE MODEL `cbi-v14.models_v4.bqml_1m_v5_5_dart_p90`
OPTIONS(
  model_type='BOOSTED_TREE_REGRESSOR',
  booster_type='DART',
  num_parallel_tree=8,
  dart_drop_rate=0.15,
  dart_skip_drop=0.4,
  max_tree_depth=12,
  learn_rate=0.09,
  l1_reg=0.5,
  l2_reg=0.2,
  subsample=0.85,
  colsample_bytree=0.75,
  quantile_alpha=0.9,                  -- 90% quantile
  early_stop=TRUE,
  min_rel_progress=0.00005,
  max_iterations=250,
  data_split_method='SEQ',
  data_split_col='date',
  data_split_eval_fraction=0.2,
  monotone_constraints = [
    ('xb_f_close', -1),
    ('ho_f_yh_close', -1),
    ('zl_f_yh_rsi_14', 1),
    ('adm_yh_volume', 1),
    ('dxy_close', -1)
  ]
) AS
SELECT 
  target_1m,  -- BQML automatically uses this as label
  date,  -- Required for data_split_col
  * EXCEPT(date, target_1m)
FROM `cbi-v14.models_v4.full_220_comprehensive_2yr`
WHERE target_1m IS NOT NULL
  AND date >= '2024-01-01';

-- ============================================
-- STEP 6: CREATE PREDICTIONS WITH RISK BANDS
-- ============================================
-- Final prediction + risk bands (strategy page ready)
-- Post-process with LEAST/GREATEST fix to ensure quantile consistency

CREATE OR REPLACE TABLE `cbi-v14.models_v4.v5_5_dart_predictions_daily` AS
WITH
p10_predictions AS (
  SELECT
    date,
    predicted_label AS p10_raw
  FROM ML.PREDICT(
    MODEL `cbi-v14.models_v4.bqml_1m_v5_5_dart_p10`,
    (SELECT * FROM `cbi-v14.models_v4.full_220_comprehensive_2yr` WHERE date >= '2024-01-01')
  )
),
p50_predictions AS (
  SELECT
    date,
    predicted_label AS p50_raw
  FROM ML.PREDICT(
    MODEL `cbi-v14.models_v4.bqml_1m_v5_5_dart_p50`,
    (SELECT * FROM `cbi-v14.models_v4.full_220_comprehensive_2yr` WHERE date >= '2024-01-01')
  )
),
p90_predictions AS (
  SELECT
    date,
    predicted_label AS p90_raw
  FROM ML.PREDICT(
    MODEL `cbi-v14.models_v4.bqml_1m_v5_5_dart_p90`,
    (SELECT * FROM `cbi-v14.models_v4.full_220_comprehensive_2yr` WHERE date >= '2024-01-01')
  )
)
SELECT
  p10.date,
  LEAST(p10.p10_raw, p50.p50_raw) AS p10_downside,  -- Ensure p10 <= p50
  p50.p50_raw AS point_forecast,
  GREATEST(p50.p50_raw, p90.p90_raw) AS p90_upside,  -- Ensure p50 <= p90
  (GREATEST(p50.p50_raw, p90.p90_raw) - LEAST(p10.p10_raw, p50.p50_raw)) / 2.0 AS uncertainty_band
FROM p10_predictions p10
JOIN p50_predictions p50 USING(date)
JOIN p90_predictions p90 USING(date);

